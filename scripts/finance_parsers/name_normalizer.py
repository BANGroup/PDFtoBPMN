"""
–ú–æ–¥—É–ª—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–º—ë–Ω –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤.

–†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –ù–†–î:
1. –†–∞–∑–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä (–ó–ê–ì–õ–ê–í–ù–´–ï vs –û–±—ã—á–Ω—ã–µ)
2. –§–æ—Ä–º—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (–û–û–û vs –û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é)
3. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º (–û–ê–û ‚Üí –ê–û)
4. –ö–∞–≤—ã—á–∫–∏ (—Ä–∞–∑–Ω—ã–µ —Å—Ç–∏–ª–∏)
5. –°—Ç–∞—Ç—É—Å—ã (–î.–£., –∏ —Ç.–¥.)
6. –ï vs –Å
7. –õ–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
8. –ò–º–µ–Ω–∞ —Å –º–∞–ª–µ–Ω—å–∫–æ–π –±—É–∫–≤—ã
9. –õ–∞—Ç–∏–Ω–∏—Ü–∞ vs –∫–∏—Ä–∏–ª–ª–∏—Ü–∞
10. –†–∞–∑–Ω—ã–µ —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏–∏
11. –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è
"""

import re
from typing import Optional


class NameNormalizer:
    """
    –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä –∏–º—ë–Ω –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ (—Ñ–∏–∑–ª–∏—Ü –∏ —é—Ä–ª–∏—Ü).
    
    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
        normalizer = NameNormalizer()
        
        # –§–ò–û —Ñ–∏–∑–ª–∏—Ü–∞
        name1 = normalizer.normalize("–Æ–®–ö–û–í –ö–û–ù–°–¢–ê–ù–¢–ò–ù –ú–ò–•–ê–ô–õ–û–í–ò–ß")
        name2 = normalizer.normalize("–Æ—à–∫–æ–≤ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ú–∏—Ö–∞–π–ª–æ–≤–∏—á")
        assert name1 == name2  # True
        
        # –Æ—Ä–ª–∏—Ü–æ
        name1 = normalizer.normalize('–û–û–û "–ò–Ω—Ñ–æ–õ–∞–¥–∞"')
        name2 = normalizer.normalize('–û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é "–ò–Ω—Ñ–æ–õ–∞–¥–∞"')
        assert name1 == name2  # True
    """
    
    # –§–æ—Ä–º—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏: –ø–æ–ª–Ω–æ–µ ‚Üí —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ
    LEGAL_FORMS = {
        '–û—Ç–∫—Ä—ã—Ç–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ': '–û–ê–û',
        '–ó–∞–∫—Ä—ã—Ç–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ': '–ó–ê–û',
        '–ê–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ': '–ê–û',
        '–ü—É–±–ª–∏—á–Ω–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ': '–ü–ê–û',
        '–û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é': '–û–û–û',
        '–û–±—â–µ—Å—Ç–≤–æ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é': '–û–î–û',
        '–ù–µ–ø—É–±–ª–∏—á–Ω–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ': '–ù–ê–û',
        '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤': '–ü–ö',
        '–¢–æ–≤–∞—Ä–∏—â–µ—Å—Ç–≤–æ –Ω–∞ –≤–µ—Ä–µ': '–¢–ù–í',
        '–ü–æ–ª–Ω–æ–µ —Ç–æ–≤–∞—Ä–∏—â–µ—Å—Ç–≤–æ': '–ü–¢',
        '–ö–æ–º–º–∞–Ω–¥–∏—Ç–Ω–æ–µ —Ç–æ–≤–∞—Ä–∏—â–µ—Å—Ç–≤–æ': '–ö–¢',
        '–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–µ —É–Ω–∏—Ç–∞—Ä–Ω–æ–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ': '–ì–£–ü',
        '–ú—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω–æ–µ —É–Ω–∏—Ç–∞—Ä–Ω–æ–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ': '–ú–£–ü',
        '–§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–µ –∫–∞–∑–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ': '–§–ö–ü',
        '–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å': '–ò–ü',
    }
    
    # –°—Ç–∞—Ç—É—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —É–¥–∞–ª—è—Ç—å
    STATUS_PATTERNS = [
        r'\s+–î\.–£\.',  # –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π —É–ø—Ä–∞–≤–ª—è—é—â–∏–π
        r'\s+–¥\.—É\.',
        r'\s+\(–î\.–£\.\)',
        r'\s+–≤ –ª–∏—Ü–µ',
        r'\s+–≤ –ª–∏—Ü–µ.*?$',  # "–≤ –ª–∏—Ü–µ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–≥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞..."
    ]
    
    # –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è
    GEO_PATTERN = r'\s+\([–ê-–Ø–∞-—è–Å—ë\s\-]+\)$'  # "(–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫)", "(–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥)"
    
    # –¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è –ª–∞—Ç–∏–Ω–∏—Ü–∞ ‚Üí –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ (–æ—Å–Ω–æ–≤–Ω—ã–µ –±—É–∫–≤—ã)
    TRANSLIT_MAP = {
        'A': '–ê', 'B': '–í', 'C': '–°', 'E': '–ï', 'H': '–ù', 'K': '–ö', 'M': '–ú',
        'O': '–û', 'P': '–†', 'T': '–¢', 'X': '–•', 'Y': '–£',
        'a': '–∞', 'c': '—Å', 'e': '–µ', 'o': '–æ', 'p': '—Ä', 'x': '—Ö', 'y': '—É',
    }
    
    def __init__(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä–∞."""
        # –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º —Ä–µ–≥—É–ª—è—Ä–∫–∏ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
        self._status_regexes = [re.compile(p, re.IGNORECASE) for p in self.STATUS_PATTERNS]
        self._geo_regex = re.compile(self.GEO_PATTERN)
        
        # –°–æ–∑–¥–∞—ë–º –æ–±—Ä–∞—Ç–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Ñ–æ—Ä–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
        self._legal_forms_reverse = {}
        for full, abbr in self.LEGAL_FORMS.items():
            self._legal_forms_reverse[abbr.lower()] = abbr
            self._legal_forms_reverse[full.lower()] = abbr
    
    def normalize(self, name: str, entity_type: Optional[str] = None) -> str:
        """
        –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∏–º—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ (—Ñ–∏–∑–ª–∏—Ü–æ –∏–ª–∏ —é—Ä–ª–∏—Ü–æ).
        
        Args:
            name: –ò—Å—Ö–æ–¥–Ω–æ–µ –∏–º—è
            entity_type: –¢–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏ ('person' –∏–ª–∏ 'legal'), –µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–µ–Ω
        
        Returns:
            –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è
        
        –ü—Ä–∏–º–µ—Ä—ã:
            >>> normalizer = NameNormalizer()
            
            # –§–ò–û —Ñ–∏–∑–ª–∏—Ü–∞
            >>> normalizer.normalize("–Æ–®–ö–û–í –ö–û–ù–°–¢–ê–ù–¢–ò–ù –ú–ò–•–ê–ô–õ–û–í–ò–ß")
            '–Æ—à–∫–æ–≤ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ú–∏—Ö–∞–π–ª–æ–≤–∏—á'
            
            >>> normalizer.normalize("–ö–∏—Å–µ–ª—ë–≤ –ï–≤–≥–µ–Ω–∏–π –Æ—Ä—å–µ–≤–∏—á")
            '–ö–∏—Å–µ–ª–µ–≤ –ï–≤–≥–µ–Ω–∏–π –Æ—Ä—å–µ–≤–∏—á'
            
            >>> normalizer.normalize("–ö—É–±—ã—à–∫–æ  –¢–∏–º–æ—Ñ–µ–π  –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á")
            '–ö—É–±—ã—à–∫–æ –¢–∏–º–æ—Ñ–µ–π –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á'
            
            >>> normalizer.normalize("–ò–≤–∞–Ω–æ–≤ –í–ª–∞–¥–∏–º–∏—Ä –í–∞—Å–∏–ª—å–µ–≤–∏—á (–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫)")
            '–ò–≤–∞–Ω–æ–≤ –í–ª–∞–¥–∏–º–∏—Ä –í–∞—Å–∏–ª—å–µ–≤–∏—á'
            
            # –Æ—Ä–ª–∏—Ü–æ
            >>> normalizer.normalize('–û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é "–ò–Ω—Ñ–æ–õ–∞–¥–∞"')
            '–û–û–û "–ò–Ω—Ñ–æ–õ–∞–¥–∞"'
            
            >>> normalizer.normalize('–û—Ç–∫—Ä—ã—Ç–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ "–°–ø–µ—Ü–º–æ–Ω—Ç–∞–∂–º–µ—Ö–∞–Ω–∏–∑–∞—Ü–∏—è"')
            '–û–ê–û "–°–ø–µ—Ü–º–æ–Ω—Ç–∞–∂–º–µ—Ö–∞–Ω–∏–∑–∞—Ü–∏—è"'
            
            >>> normalizer.normalize('–ó–∞–∫—Ä—ã—Ç–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –î–æ–º" –î.–£.')
            '–ó–ê–û –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –î–æ–º"'
        """
        if not name or not isinstance(name, str):
            return ''
        
        # 1. –ë–∞–∑–æ–≤–∞—è –æ—á–∏—Å—Ç–∫–∞
        result = name.strip()
        
        # 2. –£–¥–∞–ª–∏—Ç—å –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        result = re.sub(r'\s{2,}', ' ', result)
        
        # 3. –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –Å ‚Üí –ï
        result = result.replace('—ë', '–µ').replace('–Å', '–ï')
        
        # 4. –£–¥–∞–ª–∏—Ç—å –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è
        result = self._geo_regex.sub('', result)
        
        # 5. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω
        if entity_type is None:
            entity_type = self._detect_entity_type(result)
        
        # 6. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
        if entity_type == 'person':
            result = self._normalize_person(result)
        elif entity_type == 'legal':
            result = self._normalize_legal(result)
        else:
            # –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø - –ø—Ä–æ—Å—Ç–æ –±–∞–∑–æ–≤–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
            result = self._normalize_case(result)
        
        return result.strip()
    
    def _detect_entity_type(self, name: str) -> str:
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏: —Ñ–∏–∑–ª–∏—Ü–æ –∏–ª–∏ —é—Ä–ª–∏—Ü–æ.
        
        –≠–≤—Ä–∏—Å—Ç–∏–∫–∞:
        - –ï—Å–ª–∏ –µ—Å—Ç—å —Ñ–æ—Ä–º–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (–û–û–û, –ê–û, –∏ —Ç.–¥.) ‚Üí —é—Ä–ª–∏—Ü–æ
        - –ï—Å–ª–∏ 2-4 —Å–ª–æ–≤–∞ –±–µ–∑ –∫–∞–≤—ã—á–µ–∫ –∏ —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã ‚Üí —Ñ–∏–∑–ª–∏—Ü–æ
        - –ò–Ω–∞—á–µ ‚Üí —é—Ä–ª–∏—Ü–æ
        """
        name_lower = name.lower()
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ñ–æ—Ä–º—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
        for form in self.LEGAL_FORMS.keys():
            if form.lower() in name_lower:
                return 'legal'
        
        for abbr in self.LEGAL_FORMS.values():
            if abbr.lower() in name_lower:
                return 'legal'
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –§–ò–û (2-4 —Å–ª–æ–≤–∞, —Ç–æ–ª—å–∫–æ –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ –∏ –ª–∞—Ç–∏–Ω–∏—Ü–∞)
        words = name.split()
        if 2 <= len(words) <= 4:
            # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–µ—Ç –∫–∞–≤—ã—á–µ–∫
            if '"' not in name and '¬´' not in name and '¬ª' not in name:
                # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ —Å–ª–æ–≤–∞ —Å–æ—Å—Ç–æ—è—Ç –¢–û–õ–¨–ö–û –∏–∑ –±—É–∫–≤ (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞/–ª–∞—Ç–∏–Ω–∏—Ü–∞)
                # –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∑–∞–≥–ª–∞–≤–Ω—É—é (–∏–ª–∏ —Ö–æ—Ç—è –±—ã 2 –±—É–∫–≤—ã)
                all_words_valid = True
                for w in words:
                    if not w:
                        all_words_valid = False
                        break
                    # –°–ª–æ–≤–æ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã –∏ –¥–µ—Ñ–∏—Å (–¥–ª—è –¥–≤–æ–π–Ω—ã—Ö —Ñ–∞–º–∏–ª–∏–π)
                    if not re.match(r'^[–ê-–Ø–∞-—è–Å—ëA-Za-z\-]+$', w):
                        all_words_valid = False
                        break
                
                if all_words_valid:
                    return 'person'
        
        # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é - —é—Ä–ª–∏—Ü–æ (–æ–Ω–∏ –±–æ–ª–µ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã)
        return 'legal'
    
    def _normalize_person(self, name: str) -> str:
        """
        –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –§–ò–û —Ñ–∏–∑–ª–∏—Ü–∞.
        
        –ü—Ä–∞–≤–∏–ª–∞:
        1. –ü—Ä–∏–≤–µ—Å—Ç–∏ –∫ Title Case (–§–∞–º–∏–ª–∏—è –ò–º—è –û—Ç—á–µ—Å—Ç–≤–æ)
        2. –¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è –ª–∞—Ç–∏–Ω–∏—Ü—ã ‚Üí –∫–∏—Ä–∏–ª–ª–∏—Ü—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
        3. –£–¥–∞–ª–∏—Ç—å –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
        4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–ª–æ–≤–∞ —Å –º–∞–ª–µ–Ω—å–∫–æ–π –±—É–∫–≤—ã
        
        –ü—Ä–∏–º–µ—Ä—ã:
            "–Æ–®–ö–û–í –ö–û–ù–°–¢–ê–ù–¢–ò–ù –ú–ò–•–ê–ô–õ–û–í–ò–ß" ‚Üí "–Æ—à–∫–æ–≤ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ú–∏—Ö–∞–π–ª–æ–≤–∏—á"
            "–°—Ç—Ä—É—Ü–∫–∏–π —Å–µ—Ä–≥–µ–π —Å–µ—Ä–≥–µ–µ–≤–∏—á" ‚Üí "–°—Ç—Ä—É—Ü–∫–∏–π –°–µ—Ä–≥–µ–π –°–µ—Ä–≥–µ–µ–≤–∏—á"
            "—Å—Ç—Ä—É—Ü–∫–∏–π —Å–µ—Ä–≥–µ–π —Å–µ—Ä–≥–µ–µ–≤–∏—á" ‚Üí "–°—Ç—Ä—É—Ü–∫–∏–π –°–µ—Ä–≥–µ–π –°–µ—Ä–≥–µ–µ–≤–∏—á"
        """
        # 1. –¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å –ª–∞—Ç–∏–Ω–∏—Ü–∞ —Å—Ä–µ–¥–∏ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã)
        if self._has_mixed_scripts(name):
            name = self._transliterate_to_cyrillic(name)
        
        # 2. –ü—Ä–∏–≤–µ—Å—Ç–∏ –∫ Title Case
        # –†–∞–∑–±–∏—Ç—å –Ω–∞ —Å–ª–æ–≤–∞ –∏ –∫–∞–ø–∏—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥–æ–µ
        words = name.split()
        normalized_words = []
        
        for word in words:
            if word:
                # –ï—Å–ª–∏ —Å–ª–æ–≤–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ ‚Üí title()
                if word.isupper():
                    word = word.title()
                # –ï—Å–ª–∏ –ø–µ—Ä–≤–∞—è –±—É–∫–≤–∞ –º–∞–ª–µ–Ω—å–∫–∞—è ‚Üí capitalize()
                elif not word[0].isupper():
                    word = word.capitalize()
                # –ò–Ω–∞—á–µ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å (—É–∂–µ Title Case)
                
                normalized_words.append(word)
        
        return ' '.join(normalized_words)
    
    def _normalize_legal(self, name: str) -> str:
        """
        –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è —é—Ä–ª–∏—Ü–∞.
        
        –ü—Ä–∞–≤–∏–ª–∞:
        1. –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (–≤—Å–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è)
        2. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã (–î.–£., –∏ —Ç.–¥.)
        3. –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–∞–≤—ã—á–∫–∏ (–≤—Å–µ–≥–¥–∞ –¥–≤–æ–π–Ω—ã–µ –ø—Ä—è–º—ã–µ ")
        4. Title Case –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è
        """
        # 1. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã
        for regex in self._status_regexes:
            name = regex.sub('', name)
        
        # 2. –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
        name = self._normalize_legal_form(name)
        
        # 3. –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–∞–≤—ã—á–∫–∏
        name = self._normalize_quotes(name)
        
        # 4. –£–¥–∞–ª–∏—Ç—å –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã (–º–æ–≥–ª–∏ –ø–æ—è–≤–∏—Ç—å—Å—è –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤)
        name = re.sub(r'\s{2,}', ' ', name)
        
        return name
    
    def _normalize_legal_form(self, name: str) -> str:
        """
        –ó–∞–º–µ–Ω—è–µ—Ç –ø–æ–ª–Ω—ã–µ —Ñ–æ—Ä–º—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è.
        
        –ü—Ä–∏–º–µ—Ä—ã:
            "–û—Ç–∫—Ä—ã—Ç–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ –•" ‚Üí "–û–ê–û –•"
            "–û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é –•" ‚Üí "–û–û–û –•"
        """
        # –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º –ø–æ–ª–Ω—ã–µ —Ñ–æ—Ä–º—ã (–æ–Ω–∏ –¥–ª–∏–Ω–Ω–µ–µ)
        for full_form in sorted(self.LEGAL_FORMS.keys(), key=len, reverse=True):
            pattern = re.compile(re.escape(full_form), re.IGNORECASE)
            if pattern.search(name):
                abbr = self.LEGAL_FORMS[full_form]
                name = pattern.sub(abbr, name)
                break  # –¢–æ–ª—å–∫–æ –æ–¥–Ω–∞ –∑–∞–º–µ–Ω–∞
        
        return name
    
    def _normalize_quotes(self, name: str) -> str:
        """
        –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∫–∞–≤—ã—á–∫–∏ –∫ –µ–¥–∏–Ω–æ–º—É –≤–∏–¥—É (–¥–≤–æ–π–Ω—ã–µ –ø—Ä—è–º—ã–µ ").
        
        –ó–∞–º–µ–Ω—è–µ—Ç:
        - ¬´ ¬ª (—Ä—É—Å—Å–∫–∏–µ/—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–µ)
        - ‚Äû " (–Ω–µ–º–µ—Ü–∫–∏–µ)
        - " " (—Ç–∏–ø–æ–≥—Ä–∞—Ñ—Å–∫–∏–µ)
        - ' ' (–æ–¥–∏–Ω–∞—Ä–Ω—ã–µ –∞–ø–æ—Å—Ç—Ä–æ—Ñ—ã)
        - ' ' (–æ–¥–∏–Ω–∞—Ä–Ω—ã–µ —Ç–∏–ø–æ–≥—Ä–∞—Ñ—Å–∫–∏–µ)
        
        –ü—Ä–∏–º–µ—Ä—ã:
            –û–û–û ¬´–ö–ú —Å–µ—Ä–≤–∏—Å¬ª ‚Üí –û–û–û "–ö–ú —Å–µ—Ä–≤–∏—Å"
            –û–û–û '–ö–ú —Å–µ—Ä–≤–∏—Å' ‚Üí –û–û–û "–ö–ú —Å–µ—Ä–≤–∏—Å"
            –ë–∞–Ω–∫ –î–µ—Ä–∂–∞–≤–∞" ‚Üí "–ë–∞–Ω–∫ –î–µ—Ä–∂–∞–≤–∞"
        """
        # 1. –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –≤–∏–¥—ã –∫–∞–≤—ã—á–µ–∫ –Ω–∞ –¥–≤–æ–π–Ω—ã–µ –ø—Ä—è–º—ã–µ "
        
        # –†—É—Å—Å–∫–∏–µ/—Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–µ –∫–∞–≤—ã—á–∫–∏
        name = name.replace('¬´', '"').replace('¬ª', '"')
        
        # –ù–µ–º–µ—Ü–∫–∏–µ –∫–∞–≤—ã—á–∫–∏
        name = name.replace('‚Äû', '"').replace('"', '"')
        
        # –¢–∏–ø–æ–≥—Ä–∞—Ñ—Å–∫–∏–µ –¥–≤–æ–π–Ω—ã–µ
        name = name.replace('"', '"').replace('"', '"')
        
        # –û–¥–∏–Ω–∞—Ä–Ω—ã–µ –∞–ø–æ—Å—Ç—Ä–æ—Ñ—ã (–∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –∏ —Ç–∏–ø–æ–≥—Ä–∞—Ñ—Å–∫–∏–µ)
        name = name.replace("'", '"').replace("'", '"').replace("'", '"')
        
        # 2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–ª—É—á–∞–∏ —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏–º–∏ –∫–∞–≤—ã—á–∫–∞–º–∏
        # –ü–∞—Ç—Ç–µ—Ä–Ω: "—Å–ª–æ–≤–æ1 —Å–ª–æ–≤–æ2" —Å–ª–æ–≤–æ3" ‚Üí "—Å–ª–æ–≤–æ1 —Å–ª–æ–≤–æ2 —Å–ª–æ–≤–æ3"
        # (–µ—Å–ª–∏ –Ω–µ—á—ë—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–≤—ã—á–µ–∫)
        quote_count = name.count('"')
        if quote_count % 2 != 0:
            # –ù–∞–π—Ç–∏ –ø–µ—Ä–≤—É—é –∫–∞–≤—ã—á–∫—É
            first_quote_pos = name.find('"')
            if first_quote_pos > 0:
                # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ—Ç –ª–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π –∫–∞–≤—ã—á–∫–∏ –≤ –Ω–∞—á–∞–ª–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–∏
                # –ü–∞—Ç—Ç–µ—Ä–Ω: "–û–û–û —Å–ª–æ–≤–æ" ‚Üí "–û–û–û "—Å–ª–æ–≤–æ""
                # –ù–æ: "—Å–ª–æ–≤–æ –ê–û" ‚Üí ""—Å–ª–æ–≤–æ" –ê–û"
                
                # –ü—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –µ—Å–ª–∏ –∫–∞–≤—ã—á–∫–∞ –Ω–µ –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏,
                # –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–∫—Ä—ã–≤–∞—é—â—É—é –≤ –Ω–∞—á–∞–ª–æ –Ω–∞–∑–≤–∞–Ω–∏—è (–ø–æ—Å–ª–µ —Ñ–æ—Ä–º—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏)
                words_before = name[:first_quote_pos].strip().split()
                if words_before and words_before[0] in ['–û–û–û', '–ó–ê–û', '–û–ê–û', '–ê–û', '–ü–ê–û']:
                    # –§–æ—Ä–º–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –Ω–∞—á–∞–ª–µ - –¥–æ–±–∞–≤–∏—Ç—å –∫–∞–≤—ã—á–∫—É –ø–æ—Å–ª–µ –Ω–µ—ë
                    name = f'{words_before[0]} "{" ".join(words_before[1:])} {name[first_quote_pos+1:]}'
                else:
                    # –î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ
                    name = '"' + name
            else:
                # –ö–∞–≤—ã—á–∫–∞ –≤ –∫–æ–Ω—Ü–µ - –¥–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ
                name = '"' + name
        
        return name
    
    def _normalize_case(self, name: str) -> str:
        """
        –ë–∞–∑–æ–≤–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞ (–∫–æ–≥–¥–∞ —Ç–∏–ø –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω).
        
        –ï—Å–ª–∏ –≤—Å–µ –∑–∞–≥–ª–∞–≤–Ω—ã–µ ‚Üí Title Case.
        """
        if name.isupper():
            return name.title()
        return name
    
    def _has_mixed_scripts(self, text: str) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ —Å–º–µ—à–µ–Ω–∏–µ –ª–∞—Ç–∏–Ω–∏—Ü—ã –∏ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã.
        
        Returns:
            True, –µ—Å–ª–∏ –µ—Å—Ç—å –∏ –ª–∞—Ç–∏–Ω–∏—Ü–∞, –∏ –∫–∏—Ä–∏–ª–ª–∏—Ü–∞
        """
        has_cyrillic = bool(re.search(r'[–ê-–Ø–∞-—è–Å—ë]', text))
        has_latin = bool(re.search(r'[A-Za-z]', text))
        return has_cyrillic and has_latin
    
    def _transliterate_to_cyrillic(self, text: str) -> str:
        """
        –¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∏—Ä—É–µ—Ç –ø–æ—Ö–æ–∂–∏–µ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã –≤ –∫–∏—Ä–∏–ª–ª–∏—Ü—É.
        
        –ü—Ä–∏–º–µ—Ä—ã:
            "–ê–°–üA–ù–î–ò–Ø–†–û–í" (—Å –ª–∞—Ç–∏–Ω—Å–∫–æ–π A) ‚Üí "–ê–°–ü–ê–ù–î–ò–Ø–†–û–í" (—Å –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–æ–π –ê)
            "Sanjar Aspandiiarov" ‚Üí (–Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è, –Ω–µ—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—ã)
        """
        # –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ (–∏–Ω–∞—á–µ —ç—Ç–æ —á–∏—Å—Ç–æ –ª–∞—Ç–∏–Ω—Å–∫–æ–µ –∏–º—è)
        if not re.search(r'[–ê-–Ø–∞-—è–Å—ë]', text):
            return text
        
        result = []
        for char in text:
            result.append(self.TRANSLIT_MAP.get(char, char))
        
        return ''.join(result)
    
    def normalize_amount_with_text(self, amount_text: str) -> Optional[int]:
        """
        –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —á–∏—Å–ª–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –≤–∏–¥–∞ "123456 (—Å—Ç–æ –¥–≤–∞–¥—Ü–∞—Ç—å —Ç—Ä–∏ —Ç—ã—Å—è—á–∏...)".
        
        –ü—Ä–∞–≤–∏–ª–æ 12: —á–∏—Å–ª–æ –ø–µ—Ä–µ–¥ "(–ø—Ä–æ–ø–∏—Å—å—é)" –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–æ–π.
        
        Args:
            amount_text: –¢–µ–∫—Å—Ç —Å —á–∏—Å–ª–æ–º –∏ –ø—Ä–æ–ø–∏—Å—å—é
        
        Returns:
            –¶–µ–ª–æ–µ —á–∏—Å–ª–æ, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ —á–∏—Å–ª–æ –ø–µ—Ä–µ–¥ —Å–∫–æ–±–∫–æ–π, –∏–Ω–∞—á–µ None
        
        –ü—Ä–∏–º–µ—Ä—ã:
            >>> normalizer = NameNormalizer()
            >>> normalizer.normalize_amount_with_text("8653634 (–≤–æ—Å–µ–º—å –º–∏–ª–ª–∏–æ–Ω–æ–≤...)")
            8653634
            >>> normalizer.normalize_amount_with_text("–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç")
            None
        """
        # –ò—â–µ–º —á–∏—Å–ª–æ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π —Å–∫–æ–±–∫–æ–π
        match = re.search(r'(\d[\d\s]*\d|\d+)\s*\(', amount_text)
        if match:
            # –£–±—Ä–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã –∏–∑ —á–∏—Å–ª–∞
            number_str = match.group(1).replace(' ', '')
            try:
                return int(number_str)
            except ValueError:
                pass
        
        return None


# Singleton instance –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
_normalizer_instance = None

def get_normalizer() -> NameNormalizer:
    """
    –ü–æ–ª—É—á–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä–∞.
    
    Returns:
        –≠–∫–∑–µ–º–ø–ª—è—Ä NameNormalizer
    """
    global _normalizer_instance
    if _normalizer_instance is None:
        _normalizer_instance = NameNormalizer()
    return _normalizer_instance


def normalize_name(name: str, entity_type: Optional[str] = None) -> str:
    """
    –£–¥–æ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–º–µ–Ω–∏.
    
    Args:
        name: –ò—Å—Ö–æ–¥–Ω–æ–µ –∏–º—è
        entity_type: –¢–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏ ('person' –∏–ª–∏ 'legal')
    
    Returns:
        –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è
    """
    return get_normalizer().normalize(name, entity_type)


if __name__ == "__main__":
    """–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ —Ç–µ—Å—Ç—ã."""
    
    normalizer = NameNormalizer()
    
    print("=" * 80)
    print("–¢–ï–°–¢–´ –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–ò –ò–ú–Å–ù")
    print("=" * 80)
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 1: –†–∞–∑–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä
    print("1Ô∏è‚É£ –†–ê–ó–ù–´–ô –†–ï–ì–ò–°–¢–†:")
    names1 = [
        "–Æ—à–∫–æ–≤ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ú–∏—Ö–∞–π–ª–æ–≤–∏—á",
        "–Æ–®–ö–û–í –ö–û–ù–°–¢–ê–ù–¢–ò–ù –ú–ò–•–ê–ô–õ–û–í–ò–ß",
    ]
    for name in names1:
        print(f"   {name:50s} ‚Üí {normalizer.normalize(name)}")
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 2: –§–æ—Ä–º—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
    print("2Ô∏è‚É£ –§–û–†–ú–´ –°–û–ë–°–¢–í–ï–ù–ù–û–°–¢–ò:")
    names2 = [
        '–û–û–û "–ò–Ω—Ñ–æ–õ–∞–¥–∞"',
        '–û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é "–ò–Ω—Ñ–æ–õ–∞–¥–∞"',
    ]
    for name in names2:
        print(f"   {name:60s} ‚Üí {normalizer.normalize(name)}")
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 3: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã (–û–ê–û ‚Üí –ê–û)
    print("3Ô∏è‚É£ –ò–ó–ú–ï–ù–ï–ù–ò–ï –§–û–†–ú–´:")
    names3 = [
        '–û—Ç–∫—Ä—ã—Ç–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ "–°–ø–µ—Ü–º–æ–Ω—Ç–∞–∂–º–µ—Ö–∞–Ω–∏–∑–∞—Ü–∏—è"',
        '–ê–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ "–°–ø–µ—Ü–º–æ–Ω—Ç–∞–∂–º–µ—Ö–∞–Ω–∏–∑–∞—Ü–∏—è"',
    ]
    for name in names3:
        norm = normalizer.normalize(name)
        print(f"   {name:70s} ‚Üí {norm}")
    print("   ‚ö†Ô∏è  –û–ê–û –∏ –ê–û - —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—ã, —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –≥–æ–¥—É!")
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 4: –ö–∞–≤—ã—á–∫–∏
    print("4Ô∏è‚É£ –ö–ê–í–´–ß–ö–ò:")
    names4 = [
        '–ê–∫—Ü–∏–æ–Ω–µ—Ä–Ω—ã–π –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –±–∞–Ω–∫ –î–µ—Ä–∂–∞–≤–∞" –ø—É–±–ª–∏—á–Ω–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ"',
        '"–ê–∫—Ü–∏–æ–Ω–µ—Ä–Ω—ã–π –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –±–∞–Ω–∫ "–î–µ—Ä–∂–∞–≤–∞" –ø—É–±–ª–∏—á–Ω–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ"',
    ]
    for name in names4:
        print(f"   {name:80s}")
        print(f"   ‚Üí {normalizer.normalize(name)}")
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 5: –°—Ç–∞—Ç—É—Å—ã (–î.–£.)
    print("5Ô∏è‚É£ –°–¢–ê–¢–£–°–´:")
    names5 = [
        '–ó–∞–∫—Ä—ã—Ç–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –î–æ–º" –î.–£.',
        '–ó–∞–∫—Ä—ã—Ç–æ–µ –∞–∫—Ü–∏–æ–Ω–µ—Ä–Ω–æ–µ –æ–±—â–µ—Å—Ç–≤–æ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –î–æ–º"',
    ]
    for name in names5:
        print(f"   {name:80s}")
        print(f"   ‚Üí {normalizer.normalize(name)}")
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 6: –Å vs –ï
    print("6Ô∏è‚É£ –Å VS –ï:")
    names6 = [
        "–ö–∏—Å–µ–ª–µ–≤ –ï–≤–≥–µ–Ω–∏–π –Æ—Ä—å–µ–≤–∏—á",
        "–ö–∏—Å–µ–ª—ë–≤ –ï–≤–≥–µ–Ω–∏–π –Æ—Ä—å–µ–≤–∏—á",
    ]
    for name in names6:
        print(f"   {name:40s} ‚Üí {normalizer.normalize(name)}")
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 7: –õ–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã
    print("7Ô∏è‚É£ –õ–ò–®–ù–ò–ï –ü–†–û–ë–ï–õ–´:")
    names7 = [
        "–ö—É–±—ã—à–∫–æ  –¢–∏–º–æ—Ñ–µ–π  –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á",
        "–ö—É–±—ã—à–∫–æ –¢–∏–º–æ—Ñ–µ–π –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á",
    ]
    for name in names7:
        print(f"   '{name}' ‚Üí '{normalizer.normalize(name)}'")
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 8: –ò–º–µ–Ω–∞ —Å –º–∞–ª–µ–Ω—å–∫–æ–π –±—É–∫–≤—ã
    print("8Ô∏è‚É£ –ò–ú–ï–ù–ê –° –ú–ê–õ–ï–ù–¨–ö–û–ô –ë–£–ö–í–´:")
    names8 = [
        "–°—Ç—Ä—É—Ü–∫–∏–π –°–µ—Ä–≥–µ–π –°–µ—Ä–≥–µ–µ–≤–∏—á",
        "–°—Ç—Ä—É—Ü–∫–∏–π —Å–µ—Ä–≥–µ–π —Å–µ—Ä–≥–µ–µ–≤–∏—á",
        "—Å—Ç—Ä—É—Ü–∫–∏–π —Å–µ—Ä–≥–µ–π —Å–µ—Ä–≥–µ–µ–≤–∏—á",  # –≤—Å–µ –º–∞–ª–µ–Ω—å–∫–∏–µ
    ]
    for name in names8:
        print(f"   {name:40s} ‚Üí {normalizer.normalize(name)}")
    print()
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –∞–ø–æ—Å—Ç—Ä–æ—Ñ—ã
    print("8Ô∏è‚É£.1Ô∏è‚É£ –ê–ü–û–°–¢–†–û–§–´ –í–ú–ï–°–¢–û –ö–ê–í–´–ß–ï–ö:")
    names8_1 = [
        '–û–û–û "–ö–ú —Å–µ—Ä–≤–∏—Å"',
        "–û–û–û '–ö–ú —Å–µ—Ä–≤–∏—Å'",
    ]
    for name in names8_1:
        print(f"   {name:40s} ‚Üí {normalizer.normalize(name)}")
    print()
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: —Ä—É—Å—Å–∫–∏–µ –∫–∞–≤—ã—á–∫–∏
    print("8Ô∏è‚É£.2Ô∏è‚É£ –†–£–°–°–ö–ò–ï VS –ê–ù–ì–õ–ò–ô–°–ö–ò–ï –ö–ê–í–´–ß–ö–ò:")
    names8_2 = [
        '–û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é ¬´–ì–æ—Ä—è—á–∞—è –ª–∏–Ω–∏—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏¬ª',
        '–û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é "–ì–æ—Ä—è—á–∞—è –ª–∏–Ω–∏—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏"',
    ]
    for name in names8_2:
        print(f"   {name:80s}")
        print(f"   ‚Üí {normalizer.normalize(name)}")
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 9: –õ–∞—Ç–∏–Ω–∏—Ü–∞ vs –∫–∏—Ä–∏–ª–ª–∏—Ü–∞
    print("9Ô∏è‚É£ –õ–ê–¢–ò–ù–ò–¶–ê VS –ö–ò–†–ò–õ–õ–ò–¶–ê:")
    names9 = [
        "Sanjar Aspandiiarov",
        "–ê–°–ü–ê–ù–î–ò–Ø–†–û–í –°–ê–ù–ñ–ê–†",
    ]
    for name in names9:
        print(f"   {name:40s} ‚Üí {normalizer.normalize(name)}")
    print("   ‚ö†Ô∏è  –ü–æ–ª–Ω–∞—è —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è –ª–∞—Ç–∏–Ω–∏—Ü–∞‚Üí–∫–∏—Ä–∏–ª–ª–∏—Ü–∞ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–≤–∞—Ä—è!")
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 10: –†–∞–∑–Ω—ã–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è
    print("üîü –†–ê–ó–ù–´–ï –û–ö–û–ù–ß–ê–ù–ò–Ø:")
    names10 = [
        "–°–û–õ–ú–û–ù–ò–ê –õ–¢–î",
        "–°–û–õ–ú–û–ù–ò–Ø –õ–¢–î",
    ]
    for name in names10:
        print(f"   {name:40s} ‚Üí {normalizer.normalize(name)}")
    print("   ‚ö†Ô∏è  –û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ —Ç—Ä–µ–±—É—é—Ç fuzzy matching!")
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 11: –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è
    print("1Ô∏è‚É£1Ô∏è‚É£ –ì–ï–û–ì–†–ê–§–ò–ß–ï–°–ö–ò–ï –£–¢–û–ß–ù–ï–ù–ò–Ø:")
    names11 = [
        "–ò–≤–∞–Ω–æ–≤ –í–ª–∞–¥–∏–º–∏—Ä –í–∞—Å–∏–ª—å–µ–≤–∏—á",
        "–ò–≤–∞–Ω–æ–≤ –í–ª–∞–¥–∏–º–∏—Ä –í–∞—Å–∏–ª—å–µ–≤–∏—á (–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫)",
        "–ò–≤–∞–Ω–æ–≤ –í–ª–∞–¥–∏–º–∏—Ä –í–∞—Å–∏–ª—å–µ–≤–∏—á (–ö–æ—Ä–æ–ª–µ–≤)",
    ]
    for name in names11:
        print(f"   {name:50s} ‚Üí {normalizer.normalize(name)}")
    print()
    
    # –ü—Ä–æ–±–ª–µ–º–∞ 12: –ß–∏—Å–ª–∞ –ø—Ä–æ–ø–∏—Å—å—é
    print("1Ô∏è‚É£2Ô∏è‚É£ –ß–ò–°–õ–ê –ü–†–û–ü–ò–°–¨–Æ:")
    amounts = [
        "8653634 (–≤–æ—Å–µ–º—å –º–∏–ª–ª–∏–æ–Ω–æ–≤ —à–µ—Å—Ç—å—Å–æ—Ç –ø—è—Ç—å–¥–µ—Å—è—Ç —Ç—Ä–∏ —Ç—ã—Å—è—á–∏...)",
        "100 (—Å—Ç–æ)",
        "–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ–∫—Å—Ç",
    ]
    for amount_text in amounts:
        result = normalizer.normalize_amount_with_text(amount_text)
        print(f"   {amount_text:70s} ‚Üí {result}")
    print()
    
    print("=" * 80)
    print("‚úÖ –¢–ï–°–¢–´ –ó–ê–í–ï–†–®–ï–ù–´")
    print("=" * 80)


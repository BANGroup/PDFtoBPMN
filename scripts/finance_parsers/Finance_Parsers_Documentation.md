# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 20.11.2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–ê–≤—Ç–æ—Ä:** Cursor AI Assistant

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [Chunk Parser –¥–ª—è —Ä–µ–µ—Å—Ç—Ä–∞ –æ–±–ª–∏–≥–∞—Ü–∏–π](#chunk-parser-–¥–ª—è-—Ä–µ–µ—Å—Ç—Ä–∞-–æ–±–ª–∏–≥–∞—Ü–∏–π)
3. [VBK Hybrid Parser –¥–ª—è –≤–∞–ª—é—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è](#vbk-hybrid-parser-–¥–ª—è-–≤–∞–ª—é—Ç–Ω–æ–≥–æ-–∫–æ–Ω—Ç—Ä–æ–ª—è)
4. [Simple Order Parser (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π)](#simple-order-parser-—É—Å—Ç–∞—Ä–µ–≤—à–∏–π)
5. [–û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã](#–æ–±—â–∏–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã-—Ä–∞–±–æ—Ç—ã)
6. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

---

## –û–±–∑–æ—Ä

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç—Ä–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä—Å–µ—Ä–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ PDF:

| –ü–∞—Ä—Å–µ—Ä | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –í—Ö–æ–¥–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç | –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç | –°—Ç–∞—Ç—É—Å |
|--------|-----------|----------------|-----------------|--------|
| **Chunk Parser** | –†–µ–µ—Å—Ç—Ä –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –æ–±–ª–∏–≥–∞—Ü–∏–π | PDF ‚Üí MD | Excel (xlsx) | ‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–π |
| **VBK Hybrid Parser** | –í–∞–ª—é—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–í–ë–ö) | PDF | Excel (xlsx) | ‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–π |
| **Simple Order Parser** | –†–µ–µ—Å—Ç—Ä –æ–±–ª–∏–≥–∞—Ü–∏–π (1:1) | PDF ‚Üí MD | Excel (xlsx) | ‚ö†Ô∏è –£—Å—Ç–∞—Ä–µ–≤—à–∏–π |

---

## Chunk Parser –¥–ª—è —Ä–µ–µ—Å—Ç—Ä–∞ –æ–±–ª–∏–≥–∞—Ü–∏–π

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –≤–ª–∞–¥–µ–ª—å—Ü–∞—Ö –æ–±–ª–∏–≥–∞—Ü–∏–π –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞ –¥–µ—Ä–∂–∞—Ç–µ–ª–µ–π —Ü–µ–Ω–Ω—ã—Ö –±—É–º–∞–≥ (—Ñ–æ—Ä–º–∞—Ç –≤—ã–ø—É—Å–∫–∞ 4-02-36484-R).

### –§–∞–π–ª—ã

- **–ü–∞—Ä—Å–µ—Ä:** `scripts/finance_parser/chunk_parser_4_02.py`
- **–ó–∞–ø—É—Å–∫:** `scripts/finance_parser/run_chunk_parser_4_02.py`
- **–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö:** `scripts/finance_parser/models.py` (–∫–ª–∞—Å—Å `OwnerRecord`)

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

1. **MD —Ñ–∞–π–ª:** –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ PDF –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `output/finance/–í—ã–ø—É—Å–∫ 4-02 –Ω–∞ 16.06.2020_OCR.md`)
2. **–ò—Å—Ö–æ–¥–Ω—ã–π PDF:** –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤—Ö–æ–¥–Ω–æ–≥–æ MD:**
```markdown
–ö–æ–¥, –ø—Ä–∏—Å–≤–æ–µ–Ω–Ω—ã–π –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–º –¥–µ—Ä–∂–∞—Ç–µ–ª–µ–º, 01_031_2016_001
–§–ò–û: –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á
–ê–¥—Ä–µ—Å: RU –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥.1, –∫–≤.1
–î–æ–∫—É–º–µ–Ω—Ç: 4512 703546
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —à—Ç—É–∫–∞—Ö 50000 (–ø—è—Ç—å–¥–µ—Å—è—Ç —Ç—ã—Å—è—á)
```

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

#### –®–∞–≥ 1: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —á–∞–Ω–∫–∏

```
–¢–µ–∫—Å—Ç MD —Ñ–∞–π–ª–∞
    ‚Üì
–ü–æ–∏—Å–∫ –º–∞—Ä–∫–µ—Ä–∞ "–ö–æ–¥, –ø—Ä–∏—Å–≤–æ–µ–Ω–Ω—ã–π –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–º –¥–µ—Ä–∂–∞—Ç–µ–ª–µ–º,"
    ‚Üì
–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —á–∞–Ω–∫–∏ (–∫–∞–∂–¥—ã–π —á–∞–Ω–∫ = –æ–¥–∏–Ω –≤–ª–∞–¥–µ–ª–µ—Ü)
    ‚Üì
chunk[i] = —Ç–µ–∫—Å—Ç –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –º–∞—Ä–∫–µ—Ä–∞ –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –º–∞—Ä–∫–µ—Ä–∞
```

**–ö–ª—é—á–µ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** –ö–∞–∂–¥—ã–π —á–∞–Ω–∫ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∫–æ–¥–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è **–ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –∫–æ–¥–æ–º**.

#### –®–∞–≥ 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —á–∞–Ω–∫–∞

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞–Ω–∫–∞ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è:

1. **–ö–æ–¥ –≤–ª–∞–¥–µ–ª—å—Ü–∞ (Owner Code):**
   ```python
   regex: r'–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–º –¥–∞–Ω–Ω—ã–µ\s*\|?\s*(\d+_\d+)'
   –ø—Ä–∏–º–µ—Ä: "01_031_2016_001"
   ```

2. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–ª–∏–≥–∞—Ü–∏–π (Quantity):**
   ```python
   # –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —á–∏—Å–ª—É –ø–µ—Ä–µ–¥ "(–ø—Ä–æ–ø–∏—Å—å—é)"
   regex: r'–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —à—Ç—É–∫–∞—Ö[\s\S]{0,200}?(\d{1,7})[\s\n]+[–∞-—è—ë\s]+[\s\n]*\(–ø—Ä–æ–ø–∏—Å—å—é\)'
   
   –õ–æ–≥–∏–∫–∞:
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ —á–∏—Å–ª–æ –ø–µ—Ä–µ–¥ "(–ø—Ä–æ–ø–∏—Å—å—é)" ‚Üí –±–µ—Ä—ë–º –µ–≥–æ (—Ç–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
   - –ò–Ω–∞—á–µ: –±–µ—Ä—ë–º –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –ø–æ—Å–ª–µ "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —à—Ç—É–∫–∞—Ö"
   
   –ü—Ä–∏–º–µ—Ä:
   "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —à—Ç—É–∫–∞—Ö 100 50000 (–ø—è—Ç—å–¥–µ—Å—è—Ç —Ç—ã—Å—è—á)"
   ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç: 50000 (–≤—Ç–æ—Ä–æ–µ —á–∏—Å–ª–æ –ø–µ—Ä–µ–¥ "(–ø—Ä–æ–ø–∏—Å—å—é)")
   ```

   **‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ:**
   - –ü—Ä–æ–±–ª–µ–º–∞: –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–ø–∏—Å—è—Ö –¥–≤–∞ —á–∏—Å–ª–∞ –ø–æ—Å–ª–µ "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —à—Ç—É–∫–∞—Ö"
   - –ü–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ (100) - –∞—Ä—Ç–µ—Ñ–∞–∫—Ç/–∫–æ–¥
   - –í—Ç–æ—Ä–æ–µ —á–∏—Å–ª–æ (50000) - —Ä–µ–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
   - –†–µ—à–µ–Ω–∏–µ: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —á–∏—Å–ª—É –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –ø–µ—Ä–µ–¥ "(–ø—Ä–æ–ø–∏—Å—å—é)"

3. **–§–ò–û (Full Name):**
   ```python
   regex: r'–§–ò–û\s+([–ê-–Ø–Å][–∞-—è—ë]+(?:\s+[–ê-–Ø–Å][–∞-—è—ë]+){1,3})'
   –ø—Ä–∏–º–µ—Ä: "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á"
   ```

4. **–ê–¥—Ä–µ—Å (Address):**
   ```python
   # –û–±—ã—á–Ω—ã–π –∞–¥—Ä–µ—Å (RU):
   regex: r'–ü–æ—á—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å\s+(RU\s+\d.+?)(?=\s*–ö–æ–¥ —Å—Ç—Ä–∞–Ω—ã)'
   
   # –ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–π –∞–¥—Ä–µ—Å (–±–µ–∑ —Ü–∏—Ñ—Ä –ø–æ—Å–ª–µ –∫–æ–¥–∞ —Å—Ç—Ä–∞–Ω—ã):
   regex: r'–ü–æ—á—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å\s+([A-Z]{2}\s+.+?)(?=\s*–ö–æ–¥ —Å—Ç—Ä–∞–Ω—ã –º–µ—Å—Ç–æ–Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è)'
   ```

5. **–î–æ–∫—É–º–µ–Ω—Ç (Document Number):**
   ```python
   # –ú–∞—Ä–∫–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫:
   regex: r'–ù–æ–º–µ—Ä –∏/–∏–ª–∏ —Å–µ—Ä–∏—è[\s\n]+–¥–æ–∫—É–º–µ–Ω—Ç–∞'
   
   # –ê–ª—Ñ–∞–≤–∏—Ç–Ω–æ-—Ü–∏—Ñ—Ä–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:
   regex: r'\b([A-Z–ê-–Ø]{2,}[\s]?\d{5,15})\b'
   –ø—Ä–∏–º–µ—Ä: "–ù–ï390071", "HE 205891"
   
   # –¢–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (—Å –ø—Ä–æ–±–µ–ª–∞–º–∏):
   regex: r'\b(\d[\d ]{4,25}\d|\d{3,20})\b'
   –ø—Ä–∏–º–µ—Ä: "4512 703546" ‚Üí –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–±–µ–ª–æ–≤ ‚Üí "4512703546"
   
   # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: 3 —Ü–∏—Ñ—Ä—ã
   ```

6. **–ù–æ–º–µ—Ä —Å—á–µ—Ç–∞ (Account Number):**
   ```python
   regex: r'–ù–æ–º–µ—Ä –ª–∏—Ü–µ–≤–æ–≥–æ —Å—á–µ—Ç–∞\s+(\d+)'
   ```

#### –®–∞–≥ 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏–π (Encumbrances)

**–í–∞–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞:** "–û–±—Ä–µ–º–µ–Ω–µ–Ω–∏–µ" –æ–∑–Ω–∞—á–∞–µ—Ç "–≤ —Ç–æ–º —á–∏—Å–ª–µ", –∞ –ù–ï "–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ".

```
–ï—Å–ª–∏ –≤ —á–∞–Ω–∫–µ –Ω–∞–π–¥–µ–Ω–æ:
"–æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ X"

–¢–æ:
- –ù–ï –¥–æ–±–∞–≤–ª—è—Ç—å X –∫ –æ–±—â–µ–π —Å—É–º–º–µ
- –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è (—á–∞—Å—Ç—å –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞)

–ü—Ä–∏–º–µ—Ä:
"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —à—Ç—É–∫–∞—Ö 100000 (—Å—Ç–æ —Ç—ã—Å—è—á)
 –æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ 20000 (–¥–≤–∞–¥—Ü–∞—Ç—å —Ç—ã—Å—è—á)"

–†–µ–∑—É–ª—å—Ç–∞—Ç: quantity = 100000 (–Ω–µ 120000!)
```

#### –®–∞–≥ 4: –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π:**
   - –ö–æ–¥ –≤–ª–∞–¥–µ–ª—å—Ü–∞ (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ > 0 (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
   - –§–ò–û, –∞–¥—Ä–µ—Å, –¥–æ–∫—É–º–µ–Ω—Ç (–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã)

2. **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è:**
   - –ï—Å–ª–∏ –∫–æ–¥ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–ø–∏—Å—å —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π

#### –®–∞–≥ 5: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Excel

```python
–ö–æ–ª–æ–Ω–∫–∏ Excel:
1. –ö–æ–¥ –≤–ª–∞–¥–µ–ª—å—Ü–∞
2. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
3. –§–ò–û
4. –ê–¥—Ä–µ—Å
5. –ù–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞
6. –ù–æ–º–µ—Ä —Å—á–µ—Ç–∞

–§–æ—Ä–º–∞—Ç:
- –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è ‚Üí text
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ ‚Üí integer
```

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **‚úÖ 100% –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π** (–∫–æ–¥, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –§–ò–û, –∞–¥—Ä–µ—Å, –¥–æ–∫—É–º–µ–Ω—Ç)
2. **‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤** (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫)
3. **‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤** (–±–µ–∑ —Ü–∏—Ñ—Ä –ø–æ—Å–ª–µ –∫–æ–¥–∞ —Å—Ç—Ä–∞–Ω—ã)
4. **‚úÖ –ì–∏–±–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** (–∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ-—Ü–∏—Ñ—Ä–æ–≤—ã–µ, —Å –ø—Ä–æ–±–µ–ª–∞–º–∏, –∫–æ—Ä–æ—Ç–∫–∏–µ)
5. **‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏–π** (–Ω–µ —Å—É–º–º–∏—Ä—É–µ–º)
6. **‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ç–æ—á–Ω–æ–º—É —á–∏—Å–ª—É –ø–µ—Ä–µ–¥ "(–ø—Ä–æ–ø–∏—Å—å—é)"** (—Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –¥–≤—É—Ö —á–∏—Å–µ–ª)

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (–¥–ª—è –í—ã–ø—É—Å–∫ 4-02)

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|---------|----------|-------------|
| **–ò–∑–≤–ª–µ—á–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π** | 291 / 291 | 100% |
| **–ò–∑–≤–ª–µ—á–µ–Ω–æ –∫–æ–¥–æ–≤ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤** | 291 / 291 | 100% |
| **–ò–∑–≤–ª–µ—á–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤** | 291 / 291 | 100% |
| **–ò–∑–≤–ª–µ—á–µ–Ω–æ –§–ò–û** | 291 / 291 | 100% |
| **–ò–∑–≤–ª–µ—á–µ–Ω–æ –∞–¥—Ä–µ—Å–æ–≤** | 291 / 291 | 100% |
| **–ò–∑–≤–ª–µ—á–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** | 291 / 291 | 100% |
| **–°—É–º–º–∞ –æ–±–ª–∏–≥–∞—Ü–∏–π** | 8,653,634 | –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤—Ä—É—á–Ω—É—é ‚úÖ |
| **–†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π —Å—É–º–º–æ–π** | 525,625 | –ù–µ—Ä–∞–∑–º–µ—â—ë–Ω–Ω–∞—è —á–∞—Å—Ç—å –≤—ã–ø—É—Å–∫–∞ |

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ = 0%

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–∏—Å–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ **–ø–µ—Ä–µ–¥** –∫–æ–¥–æ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞, –∞ –Ω–µ **–ø–æ—Å–ª–µ**.

**–†–µ—à–µ–Ω–∏–µ:**
```python
# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
chunk_before_code = chunk[:code_match.start()]
quantity = search_in(chunk_before_code)

# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
chunk_after_code = chunk[code_match.end():]
quantity = search_in(chunk_after_code)
```

#### –ü—Ä–æ–±–ª–µ–º–∞ 2: –î–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –Ω–∞ 8%, –ø–æ—Ç–æ–º –ø–∞–¥–∞–µ—Ç –¥–æ 0.7%

**–ü—Ä–∏—á–∏–Ω–∞ 1:** Regex `\s` –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç `\n`, –≤–∞–ª–∏–¥–∞—Ü–∏—è `isdigit()` –ø–∞–¥–∞–µ—Ç.

**–†–µ—à–µ–Ω–∏–µ:**
```python
# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
regex: r'\b(\d[\d\s]{8,25}\d)\b'

# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ (—Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã):
regex: r'\b(\d[\d ]{8,25}\d)\b'
```

**–ü—Ä–∏—á–∏–Ω–∞ 2:** –ú–∞—Ä–∫–µ—Ä "–ù–æ–º–µ—Ä –∏/–∏–ª–∏ —Å–µ—Ä–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞" —Ä–∞–∑–±–∏—Ç –ø–µ—Ä–µ–Ω–æ—Å–æ–º —Å—Ç—Ä–æ–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:**
```python
# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
regex: r'–ù–æ–º–µ—Ä –∏/–∏–ª–∏ —Å–µ—Ä–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞'

# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ \n):
regex: r'–ù–æ–º–µ—Ä –∏/–∏–ª–∏ —Å–µ—Ä–∏—è[\s\n]+–¥–æ–∫—É–º–µ–Ω—Ç–∞'
```

#### –ü—Ä–æ–±–ª–µ–º–∞ 3: –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ —Å—É–º–º—ã –æ–±–ª–∏–≥–∞—Ü–∏–π (525,625)

**–ü—Ä–∏—á–∏–Ω–∞:** 11 –∑–∞–ø–∏—Å–µ–π —Å –¥–≤—É–º—è —á–∏—Å–ª–∞–º–∏ –ø–æ—Å–ª–µ "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —à—Ç—É–∫–∞—Ö".

**–ü—Ä–∏–º–µ—Ä:**
```
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —à—Ç—É–∫–∞—Ö 100 50000 (–ø—è—Ç—å–¥–µ—Å—è—Ç —Ç—ã—Å—è—á)
                     ‚Üë   ‚Üë
                 –∞—Ä—Ç–µ—Ñ–∞–∫—Ç  –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —á–∏—Å–ª—É –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –ø–µ—Ä–µ–¥ "(–ø—Ä–æ–ø–∏—Å—å—é)".

```python
# –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ —á–∏—Å–ª–æ –ø—Ä—è–º–æ –ø–µ—Ä–µ–¥ "(–ø—Ä–æ–ø–∏—Å—å—é)"
qty_match_with_words = re.search(
    r'–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —à—Ç—É–∫–∞—Ö[\s\S]{0,200}?(\d{1,7})[\s\n]+[–∞-—è—ë\s]+[\s\n]*\(–ø—Ä–æ–ø–∏—Å—å—é\)', 
    chunk_after_code
)

if qty_match_with_words:
    # –ù–∞—à–ª–∏ —Å –ø—Ä–æ–ø–∏—Å—å—é - —ç—Ç–æ —Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
    quantity = int(qty_match_with_words.group(1))
else:
    # –ù–µ—Ç –ø—Ä–æ–ø–∏—Å–∏ - –±–µ—Ä–µ–º –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ
    qty_match = re.search(r'–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —à—Ç—É–∫–∞—Ö[\s\S]{0,50}?(\d{1,7})', chunk_after_code)
    if qty_match:
        quantity = int(qty_match.group(1))
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from scripts.finance_parser.chunk_parser_4_02 import ChunkParser

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
parser = ChunkParser("output/finance/–í—ã–ø—É—Å–∫ 4-02 –Ω–∞ 16.06.2020_OCR.md")

# –ü–∞—Ä—Å–∏–Ω–≥
records = parser.parse()

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
parser.save_to_excel("output/finance/–í—ã–ø—É—Å–∫_4-02_—Ä–µ–∑—É–ª—å—Ç–∞—Ç.xlsx")

# –í—ã–≤–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
print(f"–ò–∑–≤–ª–µ—á–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π: {len(records)}")
print(f"–°—É–º–º–∞ –æ–±–ª–∏–≥–∞—Ü–∏–π: {sum(r.quantity for r in records):,}")
```

#### –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```python
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–ª—è–º
total = len(records)
print(f"–ö–æ–¥:     {sum(1 for r in records if r.owner_code)}/{total}")
print(f"–ö–æ–ª-–≤–æ:  {sum(1 for r in records if r.quantity)}/{total}")
print(f"–§–ò–û:     {sum(1 for r in records if r.full_name)}/{total}")
print(f"–ê–¥—Ä–µ—Å:   {sum(1 for r in records if r.address)}/{total}")
print(f"–î–æ–∫—É–º–µ–Ω—Ç: {sum(1 for r in records if r.document_number)}/{total}")
```

---

## VBK Hybrid Parser –¥–ª—è –≤–∞–ª—é—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å–ø—Ä–∞–≤–æ–∫ –æ –≤–∞–ª—é—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö (–í–ë–ö - –≤–µ–¥–æ–º–æ—Å—Ç—å –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è).

### –§–∞–π–ª—ã

- **–ü–∞—Ä—Å–µ—Ä:** `scripts/finance_parser/vbk_hybrid_parser.py`
- **–ó–∞–ø—É—Å–∫:** `scripts/finance_parser/run_vbk_all_final.py`

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**PDF —Ñ–∞–π–ª** —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏ II –∏ III:
- **–†–∞–∑–¥–µ–ª II:** –û–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É (—Å—Ç—Ä–∞–Ω–∏—Ü—ã 3-11)
- **–†–∞–∑–¥–µ–ª III:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (—Å—Ç—Ä–∞–Ω–∏—Ü—ã 12-62)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥

```
PDF —Ñ–∞–π–ª
    ‚Üì
find_tables() –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã
    ‚Üì
–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ (–≤–∫–ª—é—á–∞—è –±–µ–∑ –Ω–æ–º–µ—Ä–∞ –ø/–ø)
    ‚Üì
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–º–µ—â–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ (—É–¥–∞–ª–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç-–∫–æ–ª–æ–Ω–∫–∏)
    ‚Üì
–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫ –ø–æ –Ω–æ–º–µ—Ä–∞–º –ø/–ø
    ‚Üì
–°–∫–ª–µ–∏–≤–∞–Ω–∏–µ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π
    ‚Üì
Excel —Ñ–∞–π–ª
```

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `find_tables()` –¥–ª—è **—Å—Ç—Ä—É–∫—Ç—É—Ä—ã**, –Ω–æ **–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –≤—Ä—É—á–Ω—É—é** –ø–æ –Ω–æ–º–µ—Ä–∞–º –ø/–ø.

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

#### –®–∞–≥ 1: –ü–æ–∏—Å–∫ —Ä–∞–∑–¥–µ–ª–∞

```python
–ú–∞—Ä–∫–µ—Ä: "–†–∞–∑–¥–µ–ª II" –∏–ª–∏ "–†–∞–∑–¥–µ–ª III"
    ‚Üì
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    ‚Üì
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω–µ—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã)
```

**–ö—Ä–∏—Ç–µ—Ä–∏–π –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∞:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å —Å 19-20 –Ω–∞ 15 (–∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç)
- `abs(num_cols - other_section_cols) < abs(num_cols - expected_cols)`

#### –®–∞–≥ 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã

```python
–î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–∞–∑–¥–µ–ª–∞:
    tab_finder = page.find_tables()
    df = tab_finder.tables[0].to_pandas()
    
    –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ df:
        1. –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—É—Å—Ç—ã–µ –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏
        2. –°–ù–ê–ß–ê–õ–ê –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–º–µ—â–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ (–µ—Å–ª–∏ –µ—Å—Ç—å)
        3. –ü–û–¢–û–ú –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
        4. –î–æ–±–∞–≤–∏—Ç—å –≤ –º–∞—Å—Å–∏–≤ all_table_rows
```

#### –®–∞–≥ 3: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–º–µ—â–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö `find_tables()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–ª–∏—à–Ω—é—é –ø—É—Å—Ç—É—é –∫–æ–ª–æ–Ω–∫—É** –ø–æ—Å–ª–µ –Ω–æ–º–µ—Ä–∞ –ø/–ø.

**–ü—Ä–∏–º–µ—Ä:**
```
–°—Ç—Ä–∞–Ω–∏—Ü–∞ 3: 19 –∫–æ–ª–æ–Ω–æ–∫ (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)
[‚Ññ –ø/–ø, –î–∞—Ç–∞, –ü—Ä–∏–∑–Ω–∞–∫, ...]

–°—Ç—Ä–∞–Ω–∏—Ü–∞ 4: 20 –∫–æ–ª–æ–Ω–æ–∫ (–∞—Ä—Ç–µ—Ñ–∞–∫—Ç Col 1)
[‚Ññ –ø/–ø, None, –î–∞—Ç–∞, –ü—Ä–∏–∑–Ω–∞–∫, ...]
   ‚Üë      ‚Üë
  Col 0  Col 1 (–õ–ò–®–ù–Ø–Ø!)
```

**–†–µ—à–µ–Ω–∏–µ:**

```python
# –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –°–Ω–∞—á–∞–ª–∞ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –ü–û–¢–û–ú —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å!

if len(row) > 2:
    col0 = str(row.iloc[0]).strip()
    col1 = str(row.iloc[1]).strip()
    col2 = str(row.iloc[2]).strip()
    
    is_row_number = re.match(r'^\d{1,4}$', col0)
    
    # –°–ª—É—á–∞–π: Col 0 = –Ω–æ–º–µ—Ä, Col 1 –ø—É—Å—Ç–∞—è, Col 2 = –¥–∞—Ç–∞
    if is_row_number and col1 in ['None', 'nan', ''] and re.match(r'\d{2}\.\d{2}\.\d{4}', col2):
        # –£–¥–∞–ª—è–µ–º Col 1: [Col0, Col1, Col2, ...] ‚Üí [Col0, Col2, ...]
        row = pd.concat([row.iloc[:1], row.iloc[2:]], ignore_index=True)
        
        # –î–æ–ø–æ–ª–Ω—è–µ–º –¥–æ –Ω—É–∂–Ω–æ–π –¥–ª–∏–Ω—ã (—É–±—Ä–∞–ª–∏ 1 –∫–æ–ª–æ–Ω–∫—É, –¥–æ–±–∞–≤–ª—è–µ–º None –≤ –∫–æ–Ω–µ—Ü)
        row = pd.concat([row, pd.Series([None])], ignore_index=True)
```

**‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞):**

–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å **–¥–æ** —É–¥–∞–ª–µ–Ω–∏—è Col 1, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫:
- –°—Ç—Ä–æ–∫–∏ 18-19 –ø—Ä–æ–≤–µ—Ä—è–ª–∏—Å—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥–∞—Ç—ã –≤ Col 1 (–ø—É—Å—Ç–æ–π!)
- –§–∏–ª—å—Ç—Ä —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª: "–Ω–µ—Ç –¥–∞—Ç—ã ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å"
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å—Ç—Ä–æ–∫–∏ 18-19 –Ω–µ –∏–∑–≤–ª–µ–∫–∞–ª–∏—Å—å

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª—è–µ–º Col 1
- –ü–æ—Ç–æ–º –ø—Ä–æ–≤–µ—Ä—è–µ–º Col 1 (—Ç–µ–ø–µ—Ä—å —ç—Ç–æ –±—ã–≤—à–∞—è Col 2 —Å –¥–∞—Ç–æ–π)
- –§–∏–ª—å—Ç—Ä –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç: "–¥–∞—Ç–∞ –µ—Å—Ç—å ‚Üí –∏–∑–≤–ª–µ—á—å"

#### –®–∞–≥ 4: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫ –ø–æ –Ω–æ–º–µ—Ä–∞–º –ø/–ø

**–ê–ª–≥–æ—Ä–∏—Ç–º:**

```python
current_row_num = None
current_rows = []

–î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã:
    first_col = row.iloc[0]
    
    –ï—Å–ª–∏ first_col - —ç—Ç–æ –Ω–æ–º–µ—Ä –ø/–ø (regex: ^\d{1,4}$):
        # –≠—Ç–æ –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å
        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â—É—é –∑–∞–ø–∏—Å—å (current_row_num, current_rows)
        
        current_row_num = int(first_col)
        current_rows = [row]
    –ò–Ω–∞—á–µ:
        # –≠—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∑–∞–ø–∏—Å–∏ (–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ –ø–æ–ª–µ)
        current_rows.append(row)

–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–ø–∏—Å—å
```

**–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:** –í—Å–µ —Å—Ç—Ä–æ–∫–∏ PDF **–±–µ–∑ –Ω–æ–º–µ—Ä–∞ –ø/–ø** —Å—á–∏—Ç–∞—é—Ç—Å—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∑–∞–ø–∏—Å–∏.

**–ü—Ä–∏–º–µ—Ä:**

```
–°—Ç—Ä–æ–∫–∞ PDF 1: [18, 27.07.2016, 2, 23210, ...]
–°—Ç—Ä–æ–∫–∞ PDF 2: ["", "", "", "", "–û–ø–ª–∞—Ç–∞ –ø–æ"]
–°—Ç—Ä–æ–∫–∞ PDF 3: ["", "", "", "", "–¥–æ–≥. 4/15–ê–î"]
–°—Ç—Ä–æ–∫–∞ PDF 4: ["", "", "", "", "–æ—Ç 24.04.2015"]
    ‚Üì
–†–µ–∑—É–ª—å—Ç–∞—Ç Excel: –û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ —Å ‚Ññ18 –∏ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º:
  "–û–ø–ª–∞—Ç–∞ –ø–æ –¥–æ–≥. 4/15–ê–î –æ—Ç 24.04.2015"
```

#### –®–∞–≥ 5: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫

```python
def _merge_rows(rows: List[pd.Series]) -> pd.Series:
    """–°–∫–ª–µ–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ PDF-—Å—Ç—Ä–æ–∫ –≤ –æ–¥–Ω—É Excel-—Å—Ç—Ä–æ–∫—É"""
    
    merged = rows[0].copy()  # –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ (—Å –Ω–æ–º–µ—Ä–æ–º –ø/–ø)
    
    –î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–ª–æ–Ω–∫–∏:
        values = [row[col] –¥–ª—è –≤—Å–µ—Ö rows –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –ø—É—Å—Ç–æ–µ]
        
        –ï—Å–ª–∏ –∫–æ–ª–æ–Ω–∫–∞ —á–∏—Å–ª–æ–≤–∞—è (—Å—É–º–º—ã, –∫–æ–¥—ã):
            merged[col] = values[0]  # –ë–µ—Ä—ë–º –ø–µ—Ä–≤–æ–µ –Ω–µ–ø—É—Å—Ç–æ–µ
        –ò–Ω–∞—á–µ (—Ç–µ–∫—Å—Ç–æ–≤–∞—è):
            merged[col] = ' '.join(values)  # –°–∫–ª–µ–∏–≤–∞–µ–º —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª
    
    return merged
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è **–ø–æ–ª–Ω–æ—Å—Ç—å—é** —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!

#### –®–∞–≥ 6: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Excel

```python
–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç (0.00) –∫ –∫–æ–ª–æ–Ω–∫–∞–º —Å—É–º–º
–°–æ—Ö—Ä–∞–Ω–∏—Ç—å DataFrame –≤ Excel
```

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π** (–ø—Ä–∏–º–µ—á–∞–Ω–∏—è, –æ–ø–∏—Å–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π)
2. **‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–º–µ—â–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫** (–∞—Ä—Ç–µ—Ñ–∞–∫—Ç Col 1)
3. **‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –Ω–æ–º–µ—Ä–∞–º –ø/–ø** (–≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ –Ω–æ–º–µ—Ä–∞ = –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)
4. **‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** (62 —Å—Ç—Ä–∞–Ω–∏—Ü—ã, 2223 –∑–∞–ø–∏—Å–∏)
5. **‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü —Ä–∞–∑–¥–µ–ª–∞** (–ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—é —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã)
6. **‚úÖ –§–∏–Ω–∞–Ω—Å–æ–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (0.00 –¥–ª—è —Å—É–º–º)

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (–¥–ª—è VBK –¥–æ–∫—É–º–µ–Ω—Ç–∞)

| –†–∞–∑–¥–µ–ª | –°—Ç—Ä–∞–Ω–∏—Ü—ã | –ó–∞–ø–∏—Å–µ–π | –ö–æ–ª–æ–Ω–æ–∫ | –ü—Ä–æ–±–ª–µ–º—ã |
|--------|----------|---------|---------|----------|
| **–†–∞–∑–¥–µ–ª II** | 3-11 | 236 | 19 | ‚úÖ –ù–µ—Ç |
| **–†–∞–∑–¥–µ–ª III** | 12-62 | 2226 | 15 | ‚úÖ –ù–µ—Ç |

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä–æ–∫–∏ 18 –†–∞–∑–¥–µ–ª–∞ II (–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ):**
```
‚úÖ –î–∞—Ç–∞: 27.07.2016
‚úÖ –ö–æ–¥: 23210
‚úÖ –°—É–º–º–∞: 4,835.94
‚úÖ –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: 10 —Å—Ç—Ä–æ–∫ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ (–Ω–µ –æ–±—Ä–µ–∑–∞–Ω–æ!)
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π –†–∞–∑–¥–µ–ª–∞ III:**
```
‚úÖ –ó–∞–ø–∏—Å—å #1: F6160102, 12.04.2016
‚úÖ –ó–∞–ø–∏—Å—å #2: F6160101, 12.04.2016
‚úÖ –ó–∞–ø–∏—Å—å #3: F6160294, 13.04.2016
‚úÖ –ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å: #2226
```

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### –ü—Ä–æ–±–ª–µ–º–∞ 1: –°—Ç—Ä–æ–∫–∏ 18-19 –Ω–µ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –§–∏–ª—å—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è–ª–∏—Å—å **–¥–æ** –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–º–µ—â–µ–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫.

**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π:

```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã (Col 1 –ø—É—Å—Ç–∞—è ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å)
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–º–µ—â–µ–Ω–∏–µ

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–º–µ—â–µ–Ω–∏–µ (Col 1 —É–¥–∞–ª–µ–Ω–∞, –¥–∞—Ç–∞ —Ç–µ–ø–µ—Ä—å –≤ Col 1)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã (Col 1 —Å –¥–∞—Ç–æ–π ‚Üí –∏–∑–≤–ª–µ—á—å)
```

#### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–ª–æ–Ω–∫—É

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è Col 1 –º–∞—Å—Å–∏–≤ —Å—Ç–∞–ª –∫–æ—Ä–æ—á–µ (19 –≤–º–µ—Å—Ç–æ 20), –Ω–æ –∏–Ω–¥–µ–∫—Å—ã –Ω–µ –æ–±–Ω–æ–≤–∏–ª–∏—Å—å.

**–†–µ—à–µ–Ω–∏–µ:**

```python
# –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è Col 1 –¥–æ–±–∞–≤–∏—Ç—å None –≤ –∫–æ–Ω–µ—Ü
row = pd.concat([row.iloc[:1], row.iloc[2:]], ignore_index=True)
row = pd.concat([row, pd.Series([None])], ignore_index=True)  # ‚Üê –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ!
```

#### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ê—Ä—Ç–µ—Ñ–∞–∫—Ç Col 1 –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö

**–ü—Ä–∏—á–∏–Ω–∞:** `find_tables()` –ø–æ-—Ä–∞–∑–Ω–æ–º—É –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö.

**–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

```python
# –ï—Å–ª–∏ Col 0 = –Ω–æ–º–µ—Ä, Col 1 –ø—É—Å—Ç–∞—è, Col 2 = –¥–∞—Ç–∞ ‚Üí –∞—Ä—Ç–µ—Ñ–∞–∫—Ç
is_row_number = re.match(r'^\d{1,4}$', col0)
if is_row_number and col1 in ['None', 'nan', ''] and re.match(r'\d{2}\.\d{2}\.\d{4}', col2):
    # –£–¥–∞–ª—è–µ–º Col 1
```

#### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ü–µ—Ä–≤—ã–µ 3 –∑–∞–ø–∏—Å–∏ –†–∞–∑–¥–µ–ª–∞ III –Ω–µ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –§–∏–ª—å—Ç—Ä –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–ª–æ–Ω–∫—É –¥–ª—è –†–∞–∑–¥–µ–ª–∞ III.

**–î–µ—Ç–∞–ª–∏:**
- –†–∞–∑–¥–µ–ª II:  `[‚Ññ –ø/–ø, None, –î–∞—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏, ...]` ‚Üí –¥–∞—Ç–∞ –≤ Col 2 (–¥–æ —É–¥–∞–ª–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞) ‚Üí Col 1 (–ø–æ—Å–ª–µ)
- –†–∞–∑–¥–µ–ª III: `[‚Ññ –ø/–ø, None, –ù–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞, –î–∞—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞, ...]` ‚Üí –¥–∞—Ç–∞ –≤ Col 3

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∏–ª—å—Ç—Ä –ø—Ä–æ–≤–µ—Ä—è–ª Col 2 –¥–ª—è –†–∞–∑–¥–µ–ª–∞ III (–≥–¥–µ –Ω–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∞ –Ω–µ –¥–∞—Ç–∞), —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –ø—Ä–æ–ø—É—Å–∫—É –ø–µ—Ä–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π.

**–†–µ—à–µ–Ω–∏–µ:**

```python
# –î–ª—è –†–∞–∑–¥–µ–ª–∞ III –í–°–ï–ì–î–ê —É–¥–∞–ª—è—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç-–∫–æ–ª–æ–Ω–∫—É (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç Col 2)
if self.section == "III" and is_row_number and col1_val in ['None', 'nan', '']:
    # –£–¥–∞–ª—è–µ–º Col 1: [‚Ññ, None, –ù–æ–º–µ—Ä –¥–æ–∫, –î–∞—Ç–∞ –¥–æ–∫, ...] ‚Üí [‚Ññ, –ù–æ–º–µ—Ä –¥–æ–∫, –î–∞—Ç–∞ –¥–æ–∫, ...]
    row = pd.concat([row.iloc[:1], row.iloc[2:]], ignore_index=True)
    row = pd.concat([row, pd.Series([None])], ignore_index=True)

# –§–∏–ª—å—Ç—Ä –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤: –ø—Ä–æ–≤–µ—Ä—è—Ç—å Col 2 –¥–ª—è –†–∞–∑–¥–µ–ª–∞ III (–ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞)
if self.section == "II":
    date_col = str(row.iloc[1] if len(row) > 1 else '').strip()  # Col 1
else:  # section == "III"
    date_col = str(row.iloc[2] if len(row) > 2 else '').strip()  # Col 2
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ 2226 –∑–∞–ø–∏—Å–µ–π –∏–∑–≤–ª–µ—á–µ–Ω—ã (–±—ã–ª–æ 2223, –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–ø–∏—Å–∏ 1-3).

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–æ–≤

#### –†–∞–∑–¥–µ–ª II (19 –∫–æ–ª–æ–Ω–æ–∫)

| ‚Ññ | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –§–æ—Ä–º–∞—Ç |
|---|------------------|------------|--------|
| 1 | ‚Ññ –ø/–ø | integer | - |
| 2 | –î–∞—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ | date | DD.MM.YYYY |
| 3 | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ø—Ä–∏–∑–Ω–∞–∫) –ø–ª–∞—Ç–µ–∂–∞ | integer | - |
| 4 | –ü–æ–¥–∫–æ–ª–æ–Ω–∫–∞ 3a | text | - |
| 5 | –ö–æ–¥ –≤–∏–¥–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ | integer | - |
| 6 | –ö–æ–¥ –≤–∞–ª—é—Ç—ã (–ø–ª–∞—Ç–µ–∂) | integer | - |
| 7 | **–°—É–º–º–∞ (–ø–ª–∞—Ç–µ–∂)** | **float** | **0.00** |
| 8 | –ö–æ–¥ –≤–∞–ª—é—Ç—ã (–∫–æ–Ω—Ç—Ä–∞–∫—Ç) | integer | - |
| 9 | **–°—É–º–º–∞ (–∫–æ–Ω—Ç—Ä–∞–∫—Ç)** | **float** | **0.00** |
| 10 | –ö–æ–ª–æ–Ω–∫–∞ 9 | text | - |
| 11 | –û–∂–∏–¥–∞–µ–º—ã–π —Å—Ä–æ–∫ —Ä–µ–ø–∞—Ç—Ä–∏–∞—Ü–∏–∏ | integer | - |
| 12-17 | –ö–æ–ª–æ–Ω–∫–∏ 11-13 | text | - |
| 18 | **–¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ (–æ–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)** | **text (–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ)** | - |
| 19 | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è | text | - |

#### –†–∞–∑–¥–µ–ª III (15 –∫–æ–ª–æ–Ω–æ–∫)

| ‚Ññ | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –§–æ—Ä–º–∞—Ç |
|---|------------------|------------|--------|
| 1 | ‚Ññ –ø/–ø | integer | - |
| 2 | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç - –Ω–æ–º–µ—Ä | text | - |
| 3 | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç - –¥–∞—Ç–∞ | date | DD.MM.YYYY |
| 4 | –ö–æ–¥ –≤–∏–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ | integer | - |
| 5 | –ü—Ä–∏–∑–Ω–∞–∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤ —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–æ–º | text | - |
| 6 | –°—É–º–º–∞ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º (–¥–æ–∫—É–º–µ–Ω—Ç) - –∫–æ–¥ –≤–∞–ª—é—Ç—ã | integer | - |
| 7 | **–°—É–º–º–∞ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º (–¥–æ–∫—É–º–µ–Ω—Ç) - —Å—É–º–º–∞** | **float** | **0.00** |
| 8 | –°—É–º–º–∞ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º (–∫–æ–Ω—Ç—Ä–∞–∫—Ç) - –∫–æ–¥ –≤–∞–ª—é—Ç—ã | integer | - |
| 9 | **–°—É–º–º–∞ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º (–∫–æ–Ω—Ç—Ä–∞–∫—Ç) - —Å—É–º–º–∞** | **float** | **0.00** |
| 10 | –ü—Ä–∏–∑–Ω–∞–∫ –ø–æ—Å—Ç–∞–≤–∫–∏ | text | - |
| 11 | –°—Ä–æ–∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è | date | - |
| 12 | –ü—Ä–∏–∑–Ω–∞–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ | text | - |
| 13 | –ö–æ–¥ —Å—Ç—Ä–∞–Ω—ã –≥—Ä—É–∑–æ–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è/–≥—Ä—É–∑–æ–ø–æ–ª—É—á–∞—Ç–µ–ª—è | integer | - |
| 14 | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è | text (–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ) | - |
| 15 | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ | text (–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ) | - |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞

```python
from scripts.finance_parser.vbk_hybrid_parser import VBKHybridParser

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
parser = VBKHybridParser("input/VBK_document.pdf", section="II")

# –ü–∞—Ä—Å–∏–Ω–≥
df = parser.parse()

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
parser.save_to_excel(df, "output/finance/VBK_–†–∞–∑–¥–µ–ª_II.xlsx")

print(f"–ò–∑–≤–ª–µ—á–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π: {len(df)}")
```

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞

```python
# –†–∞–∑–¥–µ–ª II
parser_section2 = VBKHybridParser(pdf_path, section="II")
df_section2 = parser_section2.parse()
parser_section2.save_to_excel(df_section2, "output/VBK_–†–∞–∑–¥–µ–ª_II.xlsx")

# –†–∞–∑–¥–µ–ª III
parser_section3 = VBKHybridParser(pdf_path, section="III")
df_section3 = parser_section3.parse()
parser_section3.save_to_excel(df_section3, "output/VBK_–†–∞–∑–¥–µ–ª_III.xlsx")
```

#### –ê–Ω–∞–ª–∏–∑ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö –ø–æ–ª–µ–π

```python
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–ª–∏–Ω—É –ø—Ä–∏–º–µ—á–∞–Ω–∏–π
for idx, row in df.iterrows():
    note = row['–¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ (–æ–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)']
    if note and len(str(note).split('\n')) > 5:
        print(f"–°—Ç—Ä–æ–∫–∞ {row['‚Ññ –ø/–ø']}: {len(str(note).split('\n'))} —Å—Ç—Ä–æ–∫ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è")
```

---

## Simple Order Parser (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

**‚ö†Ô∏è DEPRECATED:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Chunk Parser` –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞.

–ü—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è —Ä–µ–µ—Å—Ç—Ä–∞ –æ–±–ª–∏–≥–∞—Ü–∏–π —Å 1:1 assignment (–∫–∞–∂–¥–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–æ–º—É –≤–ª–∞–¥–µ–ª—å—Ü—É).

### –§–∞–π–ª—ã

- **–ü–∞—Ä—Å–µ—Ä:** `scripts/finance_parser/simple_order_parser.py`
- **–ó–∞–ø—É—Å–∫:** `scripts/finance_parser/simple_order_parser_4_02.py`

### –û—Ç–ª–∏—á–∏—è –æ—Ç Chunk Parser

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | Simple Order Parser | Chunk Parser |
|----------------|---------------------|--------------|
| **–ú–µ—Ç–æ–¥ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è** | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ regex | –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —á–∞–Ω–∫–∏ |
| **–¢–æ—á–Ω–æ—Å—Ç—å** | ~95% | 100% |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏–π** | ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (—Å—É–º–º–∏—Ä—É–µ—Ç) | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–µ —Å—É–º–º–∏—Ä—É–µ—Ç) |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤** | ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ | ‚úÖ –ü–æ–ª–Ω–∞—è |
| **–°—Ç–∞—Ç—É—Å** | ‚ö†Ô∏è –£—Å—Ç–∞—Ä–µ–≤—à–∏–π | ‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–π |

### –ü—Ä–∏—á–∏–Ω—ã —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏–π** (—Å—á–∏—Ç–∞–µ—Ç –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–±–ª–∏–≥–∞—Ü–∏–∏)
2. **–ü—Ä–æ–±–ª–µ–º—ã —Å –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏**
3. **–ù–µ–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**
4. **–ú–µ–Ω–µ–µ —Ç–æ—á–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** (~95% vs 100%)

### –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Chunk Parser

```python
# ‚ùå –°—Ç–∞—Ä—ã–π –∫–æ–¥ (Simple Order Parser):
from scripts.finance_parser.simple_order_parser_4_02 import SimpleOrderParser
parser = SimpleOrderParser()
records = parser.parse("path/to/file.pdf")

# ‚úÖ –ù–æ–≤—ã–π –∫–æ–¥ (Chunk Parser):
from scripts.finance_parser.chunk_parser_4_02 import ChunkParser
parser = ChunkParser("path/to/file_OCR.md")
records = parser.parse()
```

---

## –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã

### 1. –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (Regex)

–í—Å–µ –ø–∞—Ä—Å–µ—Ä—ã –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç regex –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:

#### –î–∞—Ç—ã
```python
r'\d{2}\.\d{2}\.\d{4}'  # DD.MM.YYYY
```

#### –ß–∏—Å–ª–∞ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏
```python
r'\d{1,10}[,.]?\d{0,2}'  # 1234.56 –∏–ª–∏ 1234,56
```

#### –ö–æ–¥—ã –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤
```python
r'–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–º –¥–∞–Ω–Ω—ã–µ\s*\|?\s*(\d+_\d+)'  # 01_031_2016_001
```

#### –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
```python
r'–ú–∞—Ä–∫–µ—Ä[\s\S]{0,200}?–ø–∞—Ç—Ç–µ—Ä–Ω'  # –ü–æ–∏—Å–∫ —Å —É—á–µ—Ç–æ–º –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ–∫—Å—Ç –≤ PDF —á–∞—Å—Ç–æ —Ä–∞–∑–±–∏—Ç –Ω–∞ —Å—Ç—Ä–æ–∫–∏, —á—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –ø–æ–∏—Å–∫ –ø–æ regex.

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `[\s\S]` –≤–º–µ—Å—Ç–æ `.` –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤: `{0,200}` (–Ω–µ –∂–∞–¥–Ω—ã–π –ø–æ–∏—Å–∫)

**–ü—Ä–∏–º–µ—Ä:**
```python
# ‚ùå –ù–µ –Ω–∞–π–¥–µ—Ç, –µ—Å–ª–∏ "–¥–æ–∫—É–º–µ–Ω—Ç–∞" –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–µ:
r'–ù–æ–º–µ—Ä –∏/–∏–ª–∏ —Å–µ—Ä–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞'

# ‚úÖ –ù–∞–π–¥–µ—Ç –¥–∞–∂–µ —Å –ø–µ—Ä–µ–Ω–æ—Å–æ–º —Å—Ç—Ä–æ–∫–∏:
r'–ù–æ–º–µ—Ä –∏/–∏–ª–∏ —Å–µ—Ä–∏—è[\s\n]+–¥–æ–∫—É–º–µ–Ω—Ç–∞'
```

### 3. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ö–∞–∂–¥—ã–π –ø–∞—Ä—Å–µ—Ä –≤–∫–ª—é—á–∞–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é:

1. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–î–∏–∞–ø–∞–∑–æ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏–π:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ > 0, –¥–∞—Ç—ã –≤ —Ä–∞–∑—É–º–Ω—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö
3. **–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö:** –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ–∂–∏–¥–∞–µ–º—ã–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º
4. **–°—É–º–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è:** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–¥–ª—è –æ–±–ª–∏–≥–∞—Ü–∏–π)

### 4. –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è

–ï—Å–ª–∏ –≤–ª–∞–¥–µ–ª–µ—Ü/–∑–∞–ø–∏—Å—å –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã:
- –°—Ä–∞–≤–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–∞–Ω–Ω—ã—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### 5. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Excel

```python
# –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏
cell.number_format = numbers.FORMAT_NUMBER_00  # 0.00

# –¢–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏
cell.number_format = '@'  # –¢–µ–∫—Å—Ç

# –î–∞—Ç—ã
cell.number_format = 'DD.MM.YYYY'
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–µ—Å—Ç—Ä–∞ –æ–±–ª–∏–≥–∞—Ü–∏–π

```python
from scripts.finance_parser.chunk_parser_4_02 import ChunkParser

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–∞
parser = ChunkParser("output/finance/–í—ã–ø—É—Å–∫ 4-02 –Ω–∞ 16.06.2020_OCR.md")

# –ü–∞—Ä—Å–∏–Ω–≥
records = parser.parse()

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
print(f"üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´:")
print(f"   –ó–∞–ø–∏—Å–µ–π: {len(records)}")
print(f"   –°—É–º–º–∞ –æ–±–ª–∏–≥–∞—Ü–∏–π: {sum(r.quantity for r in records):,}")
print(f"   –§–ò–û –∑–∞–ø–æ–ª–Ω–µ–Ω–æ: {sum(1 for r in records if r.full_name)}/{len(records)}")
print(f"   –ê–¥—Ä–µ—Å–æ–≤: {sum(1 for r in records if r.address)}/{len(records)}")
print(f"   –î–æ–∫—É–º–µ–Ω—Ç–æ–≤: {sum(1 for r in records if r.document_number)}/{len(records)}")

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
parser.save_to_excel("output/finance/–†–µ–µ—Å—Ç—Ä_—Ä–µ–∑—É–ª—å—Ç–∞—Ç.xlsx")
```

### –ü—Ä–∏–º–µ—Ä 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ VBK –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–æ–±–∞ —Ä–∞–∑–¥–µ–ª–∞)

```python
from scripts.finance_parser.vbk_hybrid_parser import VBKHybridParser
from pathlib import Path

pdf_path = "input/VBK_document.pdf"
output_dir = Path("output/finance")
output_dir.mkdir(parents=True, exist_ok=True)

# –†–∞–∑–¥–µ–ª II
print("üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ –†–∞–∑–¥–µ–ª–∞ II...")
parser_section2 = VBKHybridParser(pdf_path, section="II")
df_section2 = parser_section2.parse()
parser_section2.save_to_excel(df_section2, str(output_dir / "VBK_–†–∞–∑–¥–µ–ª_II.xlsx"))
print(f"   ‚úÖ {len(df_section2)} –∑–∞–ø–∏—Å–µ–π")

# –†–∞–∑–¥–µ–ª III
print("üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ –†–∞–∑–¥–µ–ª–∞ III...")
parser_section3 = VBKHybridParser(pdf_path, section="III")
df_section3 = parser_section3.parse()
parser_section3.save_to_excel(df_section3, str(output_dir / "VBK_–†–∞–∑–¥–µ–ª_III.xlsx"))
print(f"   ‚úÖ {len(df_section3)} –∑–∞–ø–∏—Å–µ–π")

print("\n‚úÖ –û–ë–†–ê–ë–û–¢–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê!")
```

### –ü—Ä–∏–º–µ—Ä 3: –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```python
from openpyxl import load_workbook

# –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
wb = load_workbook("output/finance/–†–µ–µ—Å—Ç—Ä_—Ä–µ–∑—É–ª—å—Ç–∞—Ç.xlsx")
ws = wb.active

print("üìä –ê–ù–ê–õ–ò–ó –ò–ó–í–õ–ï–ß–ï–ù–ù–´–• –î–ê–ù–ù–´–•:")
print("="*80)

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º
headers = [cell.value for cell in ws[1]]
for col_idx, header in enumerate(headers, start=1):
    non_empty = sum(1 for row in range(2, ws.max_row + 1) if ws.cell(row, col_idx).value)
    pct = (non_empty / (ws.max_row - 1)) * 100
    print(f"  {header:30s}: {non_empty:4d}/{ws.max_row-1:4d} ({pct:5.1f}%)")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–º–º
total_bonds = sum(ws.cell(row, 2).value for row in range(2, ws.max_row + 1) if ws.cell(row, 2).value)
print(f"\nüí∞ –û–±—â–∞—è —Å—É–º–º–∞ –æ–±–ª–∏–≥–∞—Ü–∏–π: {total_bonds:,}")

wb.close()
```

### –ü—Ä–∏–º–µ—Ä 4: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –æ—à–∏–±–æ–∫

```python
import logging
from scripts.finance_parser.chunk_parser_4_02 import ChunkParser

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler("output/finance/parser.log"),
        logging.StreamHandler()
    ]
)

try:
    parser = ChunkParser("output/finance/–í—ã–ø—É—Å–∫ 4-02 –Ω–∞ 16.06.2020_OCR.md")
    records = parser.parse()
    parser.save_to_excel("output/finance/–†–µ–µ—Å—Ç—Ä_—Ä–µ–∑—É–ª—å—Ç–∞—Ç.xlsx")
    
    logging.info(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ {len(records)} –∑–∞–ø–∏—Å–µ–π")
    
except Exception as e:
    logging.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ: {e}", exc_info=True)
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–∞—Ä—Å–µ—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç:

1. **‚úÖ –í—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö** (100% –¥–ª—è Chunk Parser, 236/236 –¥–ª—è VBK)
2. **‚úÖ –û–±—Ä–∞–±–æ—Ç–∫—É —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤** (–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ –ø–æ–ª—è, –æ–±—Ä–µ–º–µ–Ω–µ–Ω–∏—è, –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∫–æ–ª–æ–Ω–æ–∫)
3. **‚úÖ –ì–∏–±–∫—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** (chunk-based, hybrid approaches)
4. **‚úÖ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (Excel —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö)
5. **‚úÖ –î–µ—Ç–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** (–≤–∫–ª—é—á–∞—è –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

- **–î–ª—è —Ä–µ–µ—Å—Ç—Ä–∞ –æ–±–ª–∏–≥–∞—Ü–∏–π:** `ChunkParser` (100% —Ç–æ—á–Ω–æ—Å—Ç—å)
- **–î–ª—è –≤–∞–ª—é—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è:** `VBKHybridParser` (–≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥)
- **–î–ª—è –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤:** –ò–∑—É—á–∏—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤, –ø—Ä–∏–º–µ–Ω–∏—Ç–µ best practices

### –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π

| –î–∞—Ç–∞ | –í–µ—Ä—Å–∏—è | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|--------|-----------|
| 20.11.2025 | 1.0 | –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤—Å–µ—Ö —Ç—Ä—ë—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤ |

---

**–ê–≤—Ç–æ—Ä:** Cursor AI Assistant  
**–ü—Ä–æ–µ–∫—Ç:** Obligations  
**–ö–æ–Ω—Ç–∞–∫—Ç—ã:** https://github.com/albud1978/Obligations


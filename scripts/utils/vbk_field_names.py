#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Справочник полей ВБК (Ведомость банковского контроля)

Соответствие технических кодов (D101, D202, ...) 
человекопонятным названиям согласно форме ЦБ РФ.
"""

# Раздел I. Сведения о нерезиденте - контрагенте по контракту (Table1)
TABLE1_FIELDS = {
    'RecID': '№ п/п',
    'D101': 'Наименование нерезидента',
    'D102': 'Страна регистрации',
    'D103': 'Код страны',
    'F103': 'Примечание',
}

# Раздел II. Сведения о контракте (договоре, соглашении) (Table2)
TABLE2_FIELDS = {
    'RecID': '№ п/п',
    'D104': 'Номер контракта',
    'D105': 'Дата контракта',
    'D106': 'Предмет контракта',
    'D107': 'Код валюты контракта',
    'D108': 'Вид контракта',
    'D109': 'Срок исполнения обязательств',
}

# Раздел III. Сведения о паспорте сделки (Table3)
TABLE3_FIELDS = {
    'RecID': '№ п/п',
    'D110': 'Номер по порядку',
    'D111': 'Номер паспорта сделки',
    'D112': 'Дата оформления ПС',
    'D113': 'Дата закрытия ПС',
    'D114': 'Основание оформления',
}

# Раздел IV. Сведения о представленных в банк документах (Table4)
TABLE4_FIELDS = {
    'RecID': '№ п/п',
    'D115': 'Номер по порядку',
    'D116': 'Дата представления документа',
    'D117': 'Номер документа',
    'D118': 'Дата документа',
    '@tip': 'Тип документа',
}

# Раздел VI. Сведения о поступлении/списании валюты (Table6)
TABLE6_FIELDS = {
    'RecID': '№ п/п',
    '@date': 'Дата операции',
    '@regn0': 'Паспорт сделки',
    'D201': 'Номер операции',
    'D202': 'Дата совершения операции',
    'D203': 'Код вида операции',
    'F203': 'Примечание к виду операции',
    'D204': 'Назначение платежа',
    'F204': 'Примечание к назначению',
    'D205': 'Код валюты платежа',
    'D206': 'Сумма в валюте платежа',
    'D207': 'Код валюты обязательства',
    'D208': 'Сумма в валюте обязательства',
    'F208': 'Сумма в валюте обязательства (дополнительно)',
    'G208': 'Сумма в валюте обязательства (расчетная)',
    'D209': 'Ожидаемый срок репатриации',
    'D210': 'Код страны',
    'D211': 'Код товара ТН ВЭД',
    'D212': 'Количество товара',
    'D213': 'Код единицы измерения',
    'D214': 'Цена за единицу товара',
    'D215': 'ИНН получателя/плательщика',
    'D216': 'КПП получателя/плательщика',
    'D217': 'Наименование получателя/плательщика',
    'D218': 'БИК банка',
    'D219': 'Номер счета',
    'D220': 'Номер таможенной декларации',
}

# Раздел VII. Сведения о зачете встречных требований (Table7)
TABLE7_FIELDS = {
    'RecID': '№ п/п',
    '@date': 'Дата операции',
    '@regn0': 'Паспорт сделки',
    '@tip': 'Тип операции',
    'D301': 'Номер операции',
    'D302': 'Дата зачета',
    'F302': 'Примечание к дате',
    'D303': 'Код вида операции',
    'D304': 'Назначение платежа',
    'D305': 'Код валюты платежа',
    'D306': 'Сумма в валюте платежа',
    'D307': 'Код валюты обязательства',
    'D308': 'Сумма в валюте обязательства',
    'D309': 'Ожидаемый срок репатриации',
    'D310': 'Код страны',
    'D311': 'Код товара ТН ВЭД',
    'D312': 'Количество товара',
    'D313': 'Код единицы измерения',
    'D314': 'Цена за единицу товара',
    'D315': 'ИНН контрагента',
    'D316': 'КПП контрагента',
    'D317': 'Наименование контрагента',
    'D318': 'Номер встречного паспорта',
    'D319': 'Номер встречной операции',
    'D320': 'Дата встречной операции',
}

# Раздел X. Сведения о корректировке контракта (Table10)
TABLE10_FIELDS = {
    'RecID': '№ п/п',
    '@date': 'Дата корректировки',
    '@regn0': 'Паспорт сделки',
    'D501': 'Номер корректировки',
    'D502': 'Дата документа корректировки',
    'D503': 'Номер документа корректировки',
    'D504': 'Предмет контракта (новый)',
    'D505': 'Код валюты контракта (новый)',
    'D506': 'Общая сумма контракта (новая)',
    'D507': 'Срок исполнения обязательств (новый)',
    'D508': 'Код валюты цены (новый)',
    'D509': 'Цена за единицу товара (новая)',
    'D510': 'Количество товара (новое)',
    'D511': 'Код единицы измерения (новый)',
    'D512': 'Примечание',
}

# Все справочники в одном месте
FIELD_NAMES = {
    'Table1': TABLE1_FIELDS,
    'Table2': TABLE2_FIELDS,
    'Table3': TABLE3_FIELDS,
    'Table4': TABLE4_FIELDS,
    'Table6': TABLE6_FIELDS,
    'Table7': TABLE7_FIELDS,
    'Table10': TABLE10_FIELDS,
}

# Названия таблиц для отчетов
TABLE_NAMES = {
    'Table1': 'Раздел I. Сведения о нерезиденте',
    'Table2': 'Раздел II. Сведения о контракте',
    'Table3': 'Раздел III. Паспорта сделок',
    'Table4': 'Раздел IV. Представленные документы',
    'Table6': 'Раздел VI. Движение валюты',
    'Table7': 'Раздел VII. Зачет встречных требований',
    'Table10': 'Раздел X. Корректировки контракта',
}


def get_field_name(table_name: str, field_code: str) -> str:
    """
    Получить человекопонятное название поля.
    
    Args:
        table_name: Название таблицы (Table1, Table6, ...)
        field_code: Код поля (D101, D202, ...)
    
    Returns:
        Человекопонятное название или исходный код, если не найдено
    """
    if table_name in FIELD_NAMES:
        return FIELD_NAMES[table_name].get(field_code, field_code)
    return field_code


def get_table_name(table_code: str) -> str:
    """
    Получить название раздела ВБК.
    
    Args:
        table_code: Код таблицы (Table1, Table6, ...)
    
    Returns:
        Название раздела или исходный код
    """
    return TABLE_NAMES.get(table_code, table_code)



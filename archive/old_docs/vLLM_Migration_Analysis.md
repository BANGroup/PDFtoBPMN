# üîÑ –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ—Ö–æ–¥–∞ —Å Transformers –Ω–∞ vLLM –¥–ª—è DeepSeek-OCR

**–î–∞—Ç–∞:** 07.11.2025  
**GPU:** NVIDIA GeForce RTX 5080 (16GB VRAM, Blackwell sm_120)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ –Ω–∞ Transformers

---

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –ü–†–û–ï–ö–¢–ê

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (Transformers API):

**–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- ‚úÖ **PyTorch 2.9.0+cu128** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è RTX 5080 (Blackwell, sm_120)
- ‚úÖ **flash-attn 2.7.3** - —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω –¥–ª—è sm_120 (~3.5 —á–∞—Å–∞)
- ‚úÖ **transformers 4.46.3** - —Å–æ–≤–º–µ—Å—Ç–∏–º —Å DeepSeek-OCR
- ‚úÖ **–ú–æ–¥–µ–ª—å DeepSeek-OCR** - –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ (~11-12GB)

**–†–∞–±–æ—Ç–∞—é—â–∏–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å:**
- üìÅ **–ü—É—Ç—å:** `~/PDFtoBPMN/scripts/pdf_to_context/ocr_service/app.py`
- üöÄ **API:** FastAPI (–ø–æ—Ä—Ç 8000)
- ‚ö° **Endpoints:**
  - `POST /ocr/page` - OCR —Ü–µ–ª–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  - `POST /ocr/figure` - OCR –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
  - `GET /health` - health check
- üéØ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω:** ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ 23 (55 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ BPMN –∑–∞ 31 —Å–µ–∫)
- üìà **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
  - –°—Ç—Ä–∞–Ω–∏—Ü–∞ 23 (BPMN –¥–∏–∞–≥—Ä–∞–º–º–∞): 31.29 —Å–µ–∫
  - –î–æ–∫—É–º–µ–Ω—Ç 253 —Å—Ç—Ä–∞–Ω–∏—Ü—ã: 7.6 –º–∏–Ω—É—Ç (~33 —Å—Ç—Ä–∞–Ω–∏—Ü—ã/–º–∏–Ω)
  - –ö–∞—á–µ—Å—Ç–≤–æ: –æ—Ç–ª–∏—á–Ω–æ–µ (95% compression ratio)

### ‚ùå –ß—Ç–æ –ù–ï —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:

- ‚ùå **vLLM** - –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–Ω–∏ –æ–¥–Ω–∞ –≤–µ—Ä—Å–∏—è)
- ‚ùå **vLLM —Å–∫—Ä–∏–ø—Ç—ã** - –Ω–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã (–µ—Å—Ç—å –≤ `DeepSeek-OCR-master/DeepSeek-OCR-vllm/`)

---

## üéØ –ó–ê–ß–ï–ú –ü–ï–†–ï–•–û–î–ò–¢–¨ –ù–ê vLLM?

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ vLLM:

| –ú–µ—Ç—Ä–∏–∫–∞ | Transformers (—Å–µ–π—á–∞—Å) | vLLM (–ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏) | –ü—Ä–∏—Ä–æ—Å—Ç |
|---------|----------------------|------------------------|---------|
| **1 —Å—Ç—Ä–∞–Ω–∏—Ü–∞** | ~3-5 —Å–µ–∫ | ~3-5 —Å–µ–∫ | ‚âà 0% |
| **10 —Å—Ç—Ä–∞–Ω–∏—Ü** | ~30-50 —Å–µ–∫ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ) | ~10-15 —Å–µ–∫ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ) | **~70%** ‚ö° |
| **100 —Å—Ç—Ä–∞–Ω–∏—Ü** | ~300-500 —Å–µ–∫ | ~30-60 —Å–µ–∫ | **~85%** ‚ö°‚ö° |
| **Batch processing** | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ | +100% |
| **–ü–∞–º—è—Ç—å GPU** | ~12-14 GB | ~12-14 GB | ‚âà 0% |
| **Concurrency** | 1 —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞ —Ä–∞–∑ | 50-100 —Å—Ç—Ä–∞–Ω–∏—Ü –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ | **+5000%** üöÄ |

### üìå –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ö–û–ì–î–ê –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ vLLM?

‚úÖ **–ü–ï–†–ï–ô–¢–ò –ù–ê vLLM –ö–û–ì–î–ê:**
1. –ù—É–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å **>50 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –¥–µ–Ω—å**
2. –¢—Ä–µ–±—É–µ—Ç—Å—è **batch processing** (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—á–∫–∞–º–∏)
3. –í–∞–∂–Ω–∞ **—Å–∫–æ—Ä–æ—Å—Ç—å** (–≤ 3-10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤)
4. –ù—É–∂–µ–Ω **production-ready —Å–µ—Ä–≤–∏—Å** —Å –≤—ã—Å–æ–∫–∏–º throughput

‚ö†Ô∏è **–û–°–¢–ê–í–ê–¢–¨–°–Ø –ù–ê TRANSFORMERS –ï–°–õ–ò:**
1. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ **<10 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –¥–µ–Ω—å**
2. –°–∫–æ—Ä–æ—Å—Ç—å 30-40 —Å—Ç—Ä–∞–Ω–∏—Ü/–º–∏–Ω—É—Ç—É **–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞**
3. –•–æ—Ç–∏—Ç–µ **–ø—Ä–æ—Å—Ç–æ—Ç—É –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**
4. –ë–æ–∏—Ç–µ—Å—å **–∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤–µ—Ä—Å–∏–π** –±–∏–±–ª–∏–æ—Ç–µ–∫

---

## üîß –ü–õ–ê–ù –£–°–¢–ê–ù–û–í–ö–ò vLLM

### –í–∞—Ä–∏–∞–Ω—Ç 1: Upstream vLLM (‚úÖ –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ DeepSeek-OCR —Å 23.10.2025**

```bash
cd ~/PDFtoBPMN
source DeepSeek-OCR/venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å latest –≤–µ—Ä—Å–∏—é —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π DeepSeek-OCR
pip install vllm --pre --extra-index-url https://wheels.vllm.ai/nightly
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ DeepSeek-OCR –≤ upstream
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è community

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è Nightly build (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ)
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç `transformers>=4.51.1` (—Å–µ–π—á–∞—Å 4.46.3)

### –í–∞—Ä–∏–∞–Ω—Ç 2: –°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è 0.8.5

```bash
cd ~/PDFtoBPMN
source DeepSeek-OCR/venv/bin/activate

# –°–∫–∞—á–∞—Ç—å wheel
wget https://github.com/vllm-project/vllm/releases/download/v0.8.5/vllm-0.8.5+cu118-cp310-cp310-manylinux1_x86_64.whl

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
pip install vllm-0.8.5+cu118-cp310-cp310-manylinux1_x86_64.whl
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
- ‚úÖ –ú–µ–Ω—å—à–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è CUDA 11.8 wheel (—É –Ω–∞—Å CUDA 12.8, –Ω–æ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å)
- ‚ö†Ô∏è Python 3.10 specific wheel

---

## üõ†Ô∏è –ù–ê–°–¢–†–û–ô–ö–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò

### 1. –û–±–Ω–æ–≤–∏—Ç—å config.py –¥–ª—è RTX 5080

**–§–∞–π–ª:** `~/PDFtoBPMN/DeepSeek-OCR/DeepSeek-OCR-master/DeepSeek-OCR-vllm/config.py`

```python
# ============================================================================
# –¢–ï–ö–£–©–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø: Base Mode (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è RTX 5080 16GB)
# ============================================================================
BASE_SIZE = 1024
IMAGE_SIZE = 1024
CROP_MODE = False
MIN_CROPS = 1
MAX_CROPS = 1

# ============================================================================
# –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è RTX 5080 16GB VRAM)
# ============================================================================
MAX_CONCURRENCY = 50  # –û–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è 16GB VRAM
                       # –£–º–µ–Ω—å—à–∏—Ç–µ –¥–æ 20-30 –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç CUDA OOM
                       # –£–≤–µ–ª–∏—á—å—Ç–µ –¥–æ 100 –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–ø–∞—Å VRAM

NUM_WORKERS = 32      # –í–æ—Ä–∫–µ—Ä—ã –¥–ª—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

# ============================================================================
# –ú–û–î–ï–õ–¨ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à)
# ============================================================================
MODEL_PATH = '/home/budnik_an/.cache/huggingface/hub/models--deepseek-ai--DeepSeek-OCR/snapshots/...'
# –ò–ª–∏: MODEL_PATH = 'deepseek-ai/DeepSeek-OCR' –¥–ª—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏

# ============================================================================
# –ü–£–¢–ò (–æ–±–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è Linux FS)
# ============================================================================
INPUT_PATH = '~/PDFtoBPMN/input/–î–ü-–ë6.001-07 (–≠—Ç–∞–ª–æ–Ω 2 –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è).pdf'
OUTPUT_PATH = '~/PDFtoBPMN/output_vllm/'

# ============================================================================
# –ü–†–û–ú–ü–¢ (–¥–ª—è BPMN –¥–∏–∞–≥—Ä–∞–º–º)
# ============================================================================
PROMPT = '<image>\n<|grounding|>OCR this image.'  # ocr_simple –¥–ª—è BPMN
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç—å –∫ –º–æ–¥–µ–ª–∏

```bash
# –ù–∞–π—Ç–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –º–æ–¥–µ–ª–∏ DeepSeek-OCR
find ~/.cache/huggingface/hub -name "*DeepSeek-OCR*" -type d
```

–û–±–Ω–æ–≤–∏—Ç—å `MODEL_PATH` –≤ config.py –Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã–π –ø—É—Ç—å.

---

## üöÄ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï vLLM

### –¢–µ—Å—Ç 1: –ü—Ä–æ—Å—Ç–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

```bash
cd ~/PDFtoBPMN/DeepSeek-OCR/DeepSeek-OCR-master/DeepSeek-OCR-vllm

# –û–±–Ω–æ–≤–∏—Ç—å INPUT_PATH –≤ config.py –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
python run_dpsk_ocr_image.py
```

### –¢–µ—Å—Ç 2: PDF –¥–æ–∫—É–º–µ–Ω—Ç (–Ω–∞—à —Å–ª—É—á–∞–π)

```bash
cd ~/PDFtoBPMN/DeepSeek-OCR/DeepSeek-OCR-master/DeepSeek-OCR-vllm

# –û–±–Ω–æ–≤–∏—Ç—å INPUT_PATH –≤ config.py –Ω–∞ PDF
python run_dpsk_ocr_pdf.py
```

### –¢–µ—Å—Ç 3: –°—Ç—Ä–∞–Ω–∏—Ü–∞ 23 (BPMN –¥–∏–∞–≥—Ä–∞–º–º–∞)

–°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ vLLM vs Transformers –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ 23.

---

## ‚ö†Ô∏è –ò–ó–í–ï–°–¢–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –≤–µ—Ä—Å–∏–π transformers

**–°–∏–º–ø—Ç–æ–º:**
```
vllm 0.8.5 requires transformers>=4.51.1, but you have transformers 4.46.3
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û–±–Ω–æ–≤–∏—Ç—å transformers –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ vLLM
pip install transformers==4.51.1

# –ò–õ–ò: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (DeepSeek –æ–±—ã—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å 4.46.3)
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: CUDA version mismatch

**–°–∏–º–ø—Ç–æ–º:**
```
vLLM for cu118, but we have cu128
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û–±—ã—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç cross-version
# –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤:
git clone https://github.com/vllm-project/vllm.git
cd vllm
export TORCH_CUDA_ARCH_LIST="12.0"  # RTX 5080
pip install -e .
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Triton errors

**–°–∏–º–ø—Ç–æ–º:**
```
RuntimeError: Triton kernel compilation failed
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
export TRITON_PTXAS_PATH="/usr/local/cuda-12.8/bin/ptxas"
export VLLM_USE_V1=0
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ò–º–ø–æ—Ä—Ç –æ—à–∏–±–∫–∏ SamplingMetadata

**–°–∏–º–ø—Ç–æ–º:**
```
ImportError: cannot import name 'SamplingMetadata' from 'vllm.sampling_metadata'
```

**–†–µ—à–µ–Ω–∏–µ:**
–£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ `deepseek_ocr.py` —Å—Ç—Ä–æ–∫–∞ 14:
```python
from vllm.v1.sample.metadata import SamplingMetadata  # Fixed for vLLM 0.11.0
```

---

## üìà –û–ñ–ò–î–ê–ï–ú–ê–Ø –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ –ù–ê RTX 5080

### Transformers (—Å–µ–π—á–∞—Å):
- ‚è±Ô∏è –°—Ç—Ä–∞–Ω–∏—Ü–∞ 23: **31.29 —Å–µ–∫**
- ‚è±Ô∏è –î–æ–∫—É–º–µ–Ω—Ç 253 —Å—Ç—Ä–∞–Ω–∏—Ü—ã: **7.6 –º–∏–Ω—É—Ç** (~33 —Å—Ç—Ä/–º–∏–Ω)
- üéØ Throughput: **~2.5 pages/sec** (–ø—Ä–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ)

### vLLM (–ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏):
- ‚è±Ô∏è –°—Ç—Ä–∞–Ω–∏—Ü–∞ 23: **~30-35 —Å–µ–∫** (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫, —Å—Ö–æ–∂–µ)
- ‚è±Ô∏è –î–æ–∫—É–º–µ–Ω—Ç 253 —Å—Ç—Ä–∞–Ω–∏—Ü—ã: **~2-3 –º–∏–Ω—É—Ç—ã** –ø—Ä–∏ batch processing (~85-125 —Å—Ç—Ä/–º–∏–Ω)
- üéØ Throughput: **~1500-2000 tokens/sec** (–ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ)
- üöÄ **–£—Å–∫–æ—Ä–µ–Ω–∏–µ: 3-4x** –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### ‚úÖ –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –ü–ï–†–ï–ô–¢–ò –ù–ê vLLM –ï–°–õ–ò:

1. **–û–±—ä–µ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ >50 PDF –≤ –¥–µ–Ω—å**
   - –¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞: ~6-8 —á–∞—Å–æ–≤ –Ω–∞ 50 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - vLLM: ~1.5-2 —á–∞—Å–∞ –Ω–∞ 50 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - **–≠–∫–æ–Ω–æ–º–∏—è: 4-6 —á–∞—Å–æ–≤ –≤ –¥–µ–Ω—å**

2. **–¢—Ä–µ–±—É–µ—Ç—Å—è batch processing**
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—á–∫–∞–º–∏ –ø–æ 10-50 —Å—Ç—Ä–∞–Ω–∏—Ü –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
   - –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU (–∑–∞–≥—Ä—É–∑–∫–∞ 90%+)

3. **Production environment**
   - –í—ã—Å–æ–∫–∏–π throughput
   - –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

### ‚ö†Ô∏è –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –û–°–¢–ê–¢–¨–°–Ø –ù–ê TRANSFORMERS –ï–°–õ–ò:

1. **–û–±—ä–µ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ <10 PDF –≤ –¥–µ–Ω—å**
   - –¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ
   - –°–∫–æ—Ä–æ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞
   - –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å

2. **–í–∞–∂–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**
   - –¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞
   - –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤–µ—Ä—Å–∏–π
   - –ü—Ä–æ—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É**
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ vLLM: 2-4 —á–∞—Å–∞
   - –û—Ç–ª–∞–¥–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤: 1-2 —á–∞—Å–∞
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: 1-2 —á–∞—Å–∞
   - **–ò—Ç–æ–≥–æ: 4-8 —á–∞—Å–æ–≤**

---

## üìã –ü–û–®–ê–ì–û–í–´–ô –ü–õ–ê–ù –ú–ò–ì–†–ê–¶–ò–ò

### –î–µ–Ω—å 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (2-3 —á–∞—Å–∞)

1. ‚úÖ –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ç–µ–∫—É—â–µ–≥–æ venv
   ```bash
   cp -r DeepSeek-OCR/venv DeepSeek-OCR/venv_backup
   ```

2. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å vLLM
   ```bash
   pip install vllm --pre --extra-index-url https://wheels.vllm.ai/nightly
   ```

3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å config.py –¥–ª—è RTX 5080

4. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç—ã
   ```python
   import vllm
   from vllm.model_executor.models.deepseek_ocr import DeepseekOCR
   ```

### –î–µ–Ω—å 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (3-4 —á–∞—Å–∞)

5. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å run_dpsk_ocr_image.py –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏

6. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å run_dpsk_ocr_pdf.py –Ω–∞ –º–∞–ª–µ–Ω—å–∫–æ–º PDF (10-20 —Å—Ç—Ä–∞–Ω–∏—Ü)

7. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É 23 (BPMN –¥–∏–∞–≥—Ä–∞–º–º–∞)

8. ‚úÖ –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å Transformers –≤–µ—Ä—Å–∏–µ–π

### –î–µ–Ω—å 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (2-3 —á–∞—Å–∞)

9. ‚úÖ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π OCR —Å–µ—Ä–≤–∏—Å –Ω–∞ vLLM (–∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)

10. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å PDFToContextPipeline –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å vLLM

11. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω

12. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

## üîç –ú–û–ù–ò–¢–û–†–ò–ù–ì –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:

```python
import time
import torch

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPU
print(f"VRAM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: {torch.cuda.memory_allocated() / 1024**3:.2f} GB")
print(f"VRAM –≤—ã–¥–µ–ª–µ–Ω–æ: {torch.cuda.memory_reserved() / 1024**3:.2f} GB")

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∫–æ—Ä–æ—Å—Ç–∏
start = time.time()
# ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ ...
elapsed = time.time() - start
throughput = num_pages / elapsed
print(f"–°–∫–æ—Ä–æ—Å—Ç—å: {throughput:.2f} pages/sec")
```

### –õ–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:

- ‚è±Ô∏è –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏
- ‚è±Ô∏è –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- üíæ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ VRAM
- üìä Throughput (pages/sec, tokens/sec)
- ‚ùå –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫

---

## üí° –í–´–í–û–î–´

### ‚úÖ –¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ (Transformers):
- **–†–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ** –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –æ–±—ä–µ–º–æ–≤
- **–ü—Ä–æ—Å—Ç–∞—è –∏ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è**
- **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞** –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö
- **–°–∫–æ—Ä–æ—Å—Ç—å:** 30-40 —Å—Ç—Ä–∞–Ω–∏—Ü/–º–∏–Ω—É—Ç–∞

### üöÄ –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ vLLM:
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ: 3-4x** –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **Batch processing:** 50-100 —Å—Ç—Ä–∞–Ω–∏—Ü –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- **Production-ready:** –≤—ã—Å–æ–∫–∏–π throughput
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏:** —Å—Ä–µ–¥–Ω—è—è (4-8 —á–∞—Å–æ–≤)

### üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

**–ù–∞—á–Ω–∏—Ç–µ —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è vLLM –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º venv:**

```bash
# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
python3 -m venv ~/vllm_test_env
source ~/vllm_test_env/bin/activate
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu128
pip install vllm --pre --extra-index-url https://wheels.vllm.ai/nightly
# ... —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ...
```

**–ï—Å–ª–∏ —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω—ã ‚Üí –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π venv.**

**–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã ‚Üí –æ—Å—Ç–∞—Ç—å—Å—è –Ω–∞ Transformers (—Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ).**

---

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 07.11.2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–ê–≤—Ç–æ—Ä:** AI Assistant (Cursor)



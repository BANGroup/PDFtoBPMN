# üìã –û–§–ò–¶–ò–ê–õ–¨–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø DeepSeek-OCR –¥–ª—è vLLM

**–ò—Å—Ç–æ—á–Ω–∏–∫:** https://github.com/deepseek-ai/DeepSeek-OCR  
**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 07.11.2025

---

## ‚úÖ –û–§–ò–¶–ò–ê–õ–¨–ù–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

### –í–∞—Ä–∏–∞–Ω—Ç 1: –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (DeepSeek-OCR-vllm)

**–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
```bash
Python: 3.12.9
CUDA: 11.8
PyTorch: 2.6.0
vLLM: 0.8.5
flash-attn: 2.7.3
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
conda create -n deepseek-ocr python=3.12.9 -y
conda activate deepseek-ocr

pip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/cu118

# –°–∫–∞—á–∞—Ç—å vLLM 0.8.5 wheel
wget https://github.com/vllm-project/vllm/releases/download/v0.8.5/vllm-0.8.5+cu118-cp38-abi3-manylinux1_x86_64.whl
pip install vllm-0.8.5+cu118-cp38-abi3-manylinux1_x86_64.whl

pip install flash-attn==2.7.3 --no-build-isolation
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
> if you want vLLM and transformers codes to run in the same environment, you don't need to worry about this installation error like: vllm 0.8.5+cu118 requires transformers>=4.51.1

‚Üí **–ö–æ–Ω—Ñ–ª–∏–∫—Ç –≤–µ—Ä—Å–∏–π transformers –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å!**

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: Upstream vLLM (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å 23.10.2025)

**–° 23.10.2025 DeepSeek-OCR –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ upstream vLLM:**

```bash
# Python 3.10+ (–ª—é–±–∞—è –≤–µ—Ä—Å–∏—è)
# PyTorch 2.8.0+ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
# CUDA 12.x (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ vLLM nightly (–¥–æ —Ä–µ–ª–∏–∑–∞ v0.11.1)
pip install -U vllm --pre --extra-index-url https://wheels.vllm.ai/nightly
```

**–ù–æ–≤—ã–π API (vLLM 0.11.0+):**

```python
from vllm import LLM, SamplingParams
from vllm.model_executor.models.deepseek_ocr import NGramPerReqLogitsProcessor
from PIL import Image

# –°–æ–∑–¥–∞—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å –º–æ–¥–µ–ª–∏
llm = LLM(
    model="deepseek-ai/DeepSeek-OCR",
    enable_prefix_caching=False,
    mm_processor_cache_gb=0,
    logits_processors=[NGramPerReqLogitsProcessor]
)

# –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
image_1 = Image.open("path/to/your/image.png").convert("RGB")
prompt = "<image>\nFree OCR."

model_input = [
    {
        "prompt": prompt,
        "multi_modal_data": {"image": image_1}
    }
]

sampling_param = SamplingParams(
    temperature=0.0,
    max_tokens=8192,
    # ngram logit processor args
    extra_args=dict(
        no_repeat_ngram_size=6,
        logprobs_num=1
    )
)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
output = llm.generate(model_input, sampling_param)
for out in output:
    print(out.outputs[0].text)
```

---

## üîç –ù–ê–®–ï –¢–ï–ö–£–©–ï–ï –û–ö–†–£–ñ–ï–ù–ò–ï

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –£ –Ω–∞—Å | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è |
|-----------|-------|---------------|
| **Python** | 3.10 | 3.12.9 |
| **CUDA** | 12.8 | 11.8 |
| **PyTorch** | 2.8.0+cu128 | 2.6.0+cu118 |
| **vLLM** | 0.11.0 (nightly) | 0.8.5 (–ª–æ–∫–∞–ª—å–Ω–æ) |
| **transformers** | 4.57.1 | 4.46.3 (–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å) |
| **flash-attn** | 2.7.3 ‚úÖ | 2.7.3 ‚úÖ |

---

## ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ö–æ–¥ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å vLLM 0.11.0

**–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:**
```
TypeError: DeepseekOCRMultiModalProcessor._cached_apply_hf_processor() 
got an unexpected keyword argument 'tokenization_kwargs'
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ö–æ–¥ –≤ `DeepSeek-OCR-master/DeepSeek-OCR-vllm/` –Ω–∞–ø–∏—Å–∞–Ω –¥–ª—è vLLM **0.8.5**
- –£ –Ω–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω vLLM **0.11.0** (nightly) —Å –Ω–æ–≤—ã–º API
- API –∏–∑–º–µ–Ω–∏–ª—Å—è –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ vLLM 0.8.5 (‚úÖ –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–ü–ª—é—Å—ã:**
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º `DeepSeek-OCR-vllm`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ü–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch 2.6.0
- ‚ö†Ô∏è –û—Ç–∫–∞—Ç –Ω–∞ CUDA 11.8 wheel (–¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å CUDA 12.8)

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
cd /home/budnik_an/Obligations
source DeepSeek-OCR/venv/bin/activate

# –£–¥–∞–ª–∏—Ç—å —Ç–µ–∫—É—â–∏–π vLLM –∏ PyTorch
pip uninstall vllm torch torchvision torchaudio -y

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PyTorch 2.6.0 (CUDA 11.8 —Ä–∞–±–æ—Ç–∞–µ—Ç —Å CUDA 12.8)
pip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/cu118

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å vLLM 0.8.5
wget https://github.com/vllm-project/vllm/releases/download/v0.8.5/vllm-0.8.5+cu118-cp38-abi3-manylinux1_x86_64.whl
pip install vllm-0.8.5+cu118-cp38-abi3-manylinux1_x86_64.whl

# flash-attn 2.7.3 —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚úÖ
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π API vLLM 0.11.0

**–ü–ª—é—Å—ã:**
- ‚úÖ –ù–æ–≤–µ–π—à–∞—è –≤–µ—Ä—Å–∏—è vLLM
- ‚úÖ Upstream –ø–æ–¥–¥–µ—Ä–∂–∫–∞ DeepSeek-OCR
- ‚úÖ PyTorch 2.8.0 —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∫–æ–¥ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π API)
- ‚ö†Ô∏è –ë–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏—é

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–¥ `DeepSeek-OCR-vllm`
2. –ù–∞–ø–∏—Å–∞—Ç—å –Ω–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç —Å API –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 108-150 README)
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: –û—Å—Ç–∞—Ç—å—Å—è –Ω–∞ Transformers API (‚úÖ –°–ê–ú–´–ô –ü–†–û–°–¢–û–ô)

**–ü–ª—é—Å—ã:**
- ‚úÖ **–£–ñ–ï –†–ê–ë–û–¢–ê–ï–¢ –û–¢–õ–ò–ß–ù–û**
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ 23: 1.75 —Å–µ–∫
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç 253 —Å—Ç—Ä: 7.6 –º–∏–Ω—É—Ç (~33 —Å—Ç—Ä/–º–∏–Ω)
- ‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ: 95% compression ratio
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –ù–µ—Ç batch processing
- ‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–µ–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ (–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–æ!)

---

## üí° –ú–û–Ø –§–ò–ù–ê–õ–¨–ù–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

### –î–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

**–û–°–¢–ê–¢–¨–°–Ø –ù–ê TRANSFORMERS API** –∏ –Ω–µ —Ç—Ä–∞—Ç–∏—Ç—å –≤—Ä–µ–º—è –Ω–∞ vLLM –ø–æ–∫–∞ –Ω–µ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç —Ä–µ–∞–ª—å–Ω–∞—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å.

**–ü—Ä–∏—á–∏–Ω—ã:**
1. ‚úÖ **Transformers —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ** (1.75 —Å–µ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É)
2. ‚úÖ **–ö–∞—á–µ—Å—Ç–≤–æ OCR –æ—Ç–ª–∏—á–Ω–æ–µ**
3. ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ**
4. ‚ö†Ô∏è **vLLM —Ç—Ä–µ–±—É–µ—Ç –ª–∏–±–æ –æ—Ç–∫–∞—Ç–∞ –Ω–∞ —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏, –ª–∏–±–æ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –∫–æ–¥–∞**
5. ‚ö†Ô∏è **–ü—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –µ—Å—Ç—å, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–π** (–¥–ª—è —Ç–µ–∫—É—â–∏—Ö –æ–±—ä–µ–º–æ–≤)

**–ö–æ–≥–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ vLLM:**
- üìä –ö–æ–≥–¥–∞ –æ–±—ä–µ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–µ–≤—ã—Å–∏—Ç **50 PDF/–¥–µ–Ω—å**
- üöÄ –ö–æ–≥–¥–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è **batch processing** (–¥–µ—Å—è—Ç–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
- üíº –ö–æ–≥–¥–∞ –ø—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ–π–¥–µ—Ç –≤ **production** —Å –≤—ã—Å–æ–∫–∏–º throughput

**–¢–æ–≥–¥–∞:**
- –õ–∏–±–æ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ vLLM 0.8.5 + PyTorch 2.6.0
- –õ–∏–±–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∫–æ–¥ –ø–æ–¥ –Ω–æ–≤—ã–π API vLLM 0.11.0+

---

## üìä –¢–ï–°–¢ –†–ï–ó–£–õ–¨–¢–ê–¢–´

### Transformers API (—Ç–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞):
- ‚è±Ô∏è **–°—Ç—Ä–∞–Ω–∏—Ü–∞ 23:** 1.75 —Å–µ–∫ ‚úÖ
- üì¶ **–ë–ª–æ–∫–æ–≤:** 1 (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á–µ–º—É —Ç–∞–∫ –º–∞–ª–æ!)
- üìù **Markdown:** 4 —Å–∏–º–≤–æ–ª–∞ (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å!)

### vLLM 0.11.0:
- ‚ùå **–û—à–∏–±–∫–∞:** –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å API
- ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è:** –û—Ç–∫–∞—Ç –Ω–∞ 0.8.5 –∏–ª–∏ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ –∫–æ–¥–∞

---

## üîó –°–°–´–õ–ö–ò

- **GitHub:** https://github.com/deepseek-ai/DeepSeek-OCR
- **HuggingFace:** https://huggingface.co/deepseek-ai/DeepSeek-OCR
- **vLLM Docs:** https://docs.vllm.ai/projects/recipes/en/latest/DeepSeek/DeepSeek-OCR.html
- **Paper:** https://arxiv.org/abs/2510.18234

---

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 07.11.2025  
**–í–µ—Ä—Å–∏—è:** 1.0


